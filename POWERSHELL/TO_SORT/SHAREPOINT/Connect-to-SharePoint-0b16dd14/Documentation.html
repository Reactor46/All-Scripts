<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>Connect to SharePoint Online and display all provisioned site collections</title>        
        <meta name="description" content="&#160;DescriptionThis runbook connects to SharePoint Online Admin site and display Urls of all provisioned site collections. It uses SPO Cmdlets Connect-SPOService and Get-SPOSite.
 You can use this runbook to validate basic connectivty to SPO tenant. For more details read article&#160;ht" />
        <link href="https://i1.code.msdn.s-msft.com/RequestReduceContent/c82dc8ab865be0fb7316b2e09ac97654-bafb67d64bd55a2b1fd123070a82b424-RequestReducedStyle.css" rel="Stylesheet" type="text/css" />        
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.6.1.min.js" type="text/javascript" ></script>
        <script src="https://i1.code.msdn.s-msft.com/RequestReduceContent/a12c72272a8fe142a00d8aae0ff5525e-cf9957f54e208c66abb738158989dd84-RequestReducedScript.js" type="text/javascript" ></script>                        <script type="text/javascript">
            function initializePage() {
                var activeTabData = 'activeTab';
                var otherTabClass = 'otherTab';
                var hiddenPreClass = 'hidden';
                $("a[href^=#]").attr("target","_self");
                $("div.scriptcode").each(function (i) {
                    var scriptBlock = $(this);
                    scriptBlock.trackCopy(trackCodeSnippetCodeDownload);
                    var labelElems = scriptBlock.find("div.title > span");
                    if (labelElems.length == 0) {
                        labelElems = scriptBlock.find("div.title");
                    }
                    var languageSpans = scriptBlock.find("span.hidden");
                    var pres = scriptBlock.find("pre");
                    if (languageSpans.length > 0 && pres.length > 1) {
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            var languageSpan = $(languageSpans[index]);
                            labelSpan.data('code', codePre.text().replace(/(\r(\n)?)|((\r)?\n)/ig, '\r\n'));
                            codePre.removeClass(hiddenPreClass);  
                            codePre.addClass(languageSpan.text().replace(/^\s+|\s+$/g,""));
                            codePre.chili();
                            languageSpan.remove();
                        });

                        pres = scriptBlock.find("pre");
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            if (index == 0) {
                                scriptBlock.data(activeTabData, 0);
                            }
                            else {
                                labelSpan.addClass(otherTabClass);
                                codePre.addClass(hiddenPreClass);  
                            }
                            labelSpan.click(function (e) {
                                var activeTab = scriptBlock.data(activeTabData);
                                $(labelElems[activeTab]).addClass(otherTabClass);   
                                $(pres[activeTab]).addClass(hiddenPreClass);   
                                        
                                codePre.removeClass(hiddenPreClass);    
                                labelSpan.removeClass(otherTabClass);
                                scriptBlock.data(activeTabData, index);

                                if( window.parent.Galleries ) {
                                    window.parent.Galleries.project.resizeDesc();
                                }
                            });
                        });

                        var preview = scriptBlock.find('div.preview');
                        if (preview.length == 0) {
                            preview = $(pres[pres.length - 1]);
                        }
                        preview.remove();

                        if (window.clipboardData && clipboardData.setData) {
                            var copyLink = $("<a href='#' class='copyCode'>Copy code</a>");
                            copyLink.click(function (e) {
                                trackCodeSnippetCodeDownload();
                                clipboardData.setData("Text", $(labelElems[scriptBlock.data(activeTabData)]).data('code'));
                                return false;
                            });
                            $(this).prepend(copyLink);
                        }
                    }
                });

                if ((window.parent) && (window.parent.Galleries)) {
                    window.parent.Galleries.project.resizeDesc();
                }

                    if (top.location == self.location) {
                         window.location.replace(window.location.href.replace('/description', ''));
                    }
            }

            function trackCodeSnippetCodeDownload() {
                if ((window.parent) && (window.parent.gTracker)) {
                    window.parent.gTracker.createActionEvent('Description', 'Download', 'Copy', 'CodeSnippet', null);
                }
            }
            
            function overrideAnchorLinksForFirefoxAndChrome(iframeId) {
                if(($.browser.mozilla && parseInt($.browser.version, 10) >= 2) || $.browser.webkit) {
                    var iframeOffset = $("#" + iframeId, window.parent.document).offset();
                    $("a").each(function () {
                        var link = $(this);
                        var href = link.attr("href");
                        if (href && href[0] == "#") {
                            var name = href.substring(1);
                            $(this).click(function () {
                                var nameElement = $("[name='" + name + "']");
                                var idElement = $("#" + name);
                                var element = null;
                                if (nameElement.length > 0) {
                                    element = nameElement;
                                } else if (idElement.length > 0) {
                                    element = idElement;
                                }

                                if (element) {
                                    var offset = element.offset();
                                    window.parent.scrollTo(offset.left, offset.top + iframeOffset.top);
                                }

                                return false;
                            });
                        }
                    });
                }
            }

            $(window).load(function(){
                initializePage();
                overrideAnchorLinksForFirefoxAndChrome("longdescIframe");

            });

        </script>
        <base target="_parent" />
    </head>
    <body>
        <div id="longDesc">
            
<p><span style="font-family:Times New Roman; font-size:small">&nbsp;</span><strong style="line-height:normal; font-size:10px"><span style="color:black; font-family:&quot;Segoe UI&quot;,&quot;sans-serif&quot;; font-size:9.5pt">Description</span></strong></p>
<p><span style="font-family:'Segoe UI',sans-serif; font-size:9.5pt; line-height:normal">This runbook connects to SharePoint Online Admin site and display Urls of all provisioned site collections. It uses SPO Cmdlets Connect-SPOService and Get-SPOSite. You can
 use this runbook to validate basic connectivty to SPO tenant. For more details read article&nbsp;http://tinyurl.com/SPOAzAutomate</span></p>
<p><span style="font-family:'Segoe UI',sans-serif; font-size:9.5pt; line-height:normal">&nbsp;</span><strong style="line-height:normal; font-size:10px"><span style="color:black; font-family:&quot;Segoe UI&quot;,&quot;sans-serif&quot;; font-size:9.5pt">Requirements</span></strong></p>
<p><strong style="line-height:normal; font-size:10px"><span style="color:black; font-family:&quot;Segoe UI&quot;,&quot;sans-serif&quot;; font-size:9.5pt">&nbsp;</span></strong><span style="font-family:'Segoe UI',sans-serif; font-size:9.5pt">Before running this runbook, make sure
 the following components are available:</span></p>
<ol>
<li><span style="font-family:'Segoe UI',sans-serif; font-size:9.5pt">Automation Module Asset containing Microsoft SharePoint Online PowerShell Integration Module.</span>
</li><li><span style="font-family:'Segoe UI',sans-serif; font-size:9.5pt">Automation Credential Asset containing the admin user id and the password for the SharePoint Online (SPO) tenant.</span>
</li></ol>
<p><strong style="font-size:11pt; font-family:Calibri,sans-serif"><span style="color:black; font-family:&quot;Segoe UI&quot;,&quot;sans-serif&quot;; font-size:9.5pt">Runbook Contents</span></strong></p>
<ul style="list-style-type:disc; direction:ltr">
<li style="color:black; font-family:&quot;Segoe UI&quot;,&quot;sans-serif&quot;; font-size:9.5pt; font-style:normal; font-weight:normal">
<p style="color:#000000; line-height:normal; font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;; font-size:11pt; font-style:normal; font-weight:normal; margin-top:0in; margin-bottom:8pt">
<span style="color:black; font-family:&quot;Segoe UI&quot;,&quot;sans-serif&quot;; font-size:9.5pt">The runbook's contents are displayed below:&nbsp;</span></p>
</li></ul>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell Workflow</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershellworkflow</span>
<pre class="hidden">&lt;# 
.SYNOPSIS  
    Connect to SharePoint Online (SPO) Admin Site and display Urls of all provisioned site collections.
    
.DESCRIPTION 
    This runbook displays Url of all the provisioned SPO site collections forparticular Office 365 tenant.
Prereq:    
    1. Automation Module Asset containing SPO integration module.
    2. Automation Credential Asset containing the admin user id and the password for SPO tenant. 

.PARAMETER  SPOAdminSiteUrl 
    String Url to the SPO Admin Site. 
    Example: https//:{tenant}-admin.sharepoint.com 
 
.PARAMETER  PSCredName
    String name of PSCredential Asset. 
    Example: SPOAdminCred. The asset with name 'SPOAdminCred'' must be present as a Credential asset of type PSCredential. 

.EXAMPLE 
   Display-AllSPOSites -SPOAdminSiteUrl &quot;https://{tenant}-admin.sharepoint.com&quot; -PSCredName &quot;SPOAdminCred&quot;

.NOTES 
    Author: Razi Rais 
    Details: http://tinyurl.com/SPOAzAutomate  
    Last Updated: 8/22/2014    
#&gt; 
workflow Display-AllSPOSites
{
    param( 
            [OutputType([string[]])]
          
            [Parameter(Mandatory=$true)]
            [string] 
            $SPOAdminSiteUrl,
            
            [Parameter(Mandatory=$true)]   
            [string] 
            $PSCredName
         )
        
 $PSCred = Get-AutomationPSCredential -Name $PSCredName
 Write-Output &quot;Connecting to SPO Admin Site: '$SPOAdminSiteUrl' using account:&quot; $PSCred.UserName
 Connect-SPOService -Url $SPOAdminSiteUrl -Credential $PSCred   
 Get-SPOSite | % { Write-Output (&quot;Site:&quot; &#43; $_.Url) }  
}</pre>
<div class="preview">
<pre class="powershellworkflow"><span class="powerShellWorkflow__mlcom">&lt;#&nbsp;&nbsp;
.SYNOPSIS&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Connect&nbsp;to&nbsp;SharePoint&nbsp;Online&nbsp;(SPO)&nbsp;Admin&nbsp;Site&nbsp;and&nbsp;display&nbsp;Urls&nbsp;of&nbsp;all&nbsp;provisioned&nbsp;site&nbsp;collections.&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
.DESCRIPTION&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;runbook&nbsp;displays&nbsp;Url&nbsp;of&nbsp;all&nbsp;the&nbsp;provisioned&nbsp;SPO&nbsp;site&nbsp;collections&nbsp;forparticular&nbsp;Office&nbsp;365&nbsp;tenant.&nbsp;
Prereq:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;Automation&nbsp;Module&nbsp;Asset&nbsp;containing&nbsp;SPO&nbsp;integration&nbsp;module.&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Automation&nbsp;Credential&nbsp;Asset&nbsp;containing&nbsp;the&nbsp;admin&nbsp;user&nbsp;id&nbsp;and&nbsp;the&nbsp;password&nbsp;for&nbsp;SPO&nbsp;tenant.&nbsp;&nbsp;
&nbsp;
.PARAMETER&nbsp;&nbsp;SPOAdminSiteUrl&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;Url&nbsp;to&nbsp;the&nbsp;SPO&nbsp;Admin&nbsp;Site.&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Example:&nbsp;https//:{tenant}-admin.sharepoint.com&nbsp;&nbsp;
&nbsp;&nbsp;
.PARAMETER&nbsp;&nbsp;PSCredName&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;name&nbsp;of&nbsp;PSCredential&nbsp;Asset.&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Example:&nbsp;SPOAdminCred.&nbsp;The&nbsp;asset&nbsp;with&nbsp;name&nbsp;'SPOAdminCred''&nbsp;must&nbsp;be&nbsp;present&nbsp;as&nbsp;a&nbsp;Credential&nbsp;asset&nbsp;of&nbsp;type&nbsp;PSCredential.&nbsp;&nbsp;
&nbsp;
.EXAMPLE&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;Display-AllSPOSites&nbsp;-SPOAdminSiteUrl&nbsp;&quot;https://{tenant}-admin.sharepoint.com&quot;&nbsp;-PSCredName&nbsp;&quot;SPOAdminCred&quot;&nbsp;
&nbsp;
.NOTES&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Author:&nbsp;Razi&nbsp;Rais&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Details:&nbsp;http://tinyurl.com/SPOAzAutomate&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Last&nbsp;Updated:&nbsp;8/22/2014&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
#&gt;</span>&nbsp;&nbsp;
<span class="powerShellWorkflow__keyword">workflow</span>&nbsp;Display<span class="powerShellWorkflow__operator">-</span>AllSPOSites&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShellWorkflow__keyword">param</span>(&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[OutputType([string[]])]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Parameter(Mandatory=<span class="powerShellWorkflow__variable">$true</span>)]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[string]&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShellWorkflow__variable">$SPOAdminSiteUrl</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Parameter(Mandatory=<span class="powerShellWorkflow__variable">$true</span>)]&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[string]&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShellWorkflow__variable">$PSCredName</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;<span class="powerShellWorkflow__variable">$PSCred</span>&nbsp;=&nbsp;Get<span class="powerShellWorkflow__operator">-</span>AutomationPSCredential&nbsp;<span class="powerShellWorkflow__operator">-</span>Name&nbsp;<span class="powerShellWorkflow__variable">$PSCredName</span>&nbsp;
&nbsp;Write<span class="powerShellWorkflow__operator">-</span>Output&nbsp;<span class="powerShellWorkflow__string">&quot;Connecting&nbsp;to&nbsp;SPO&nbsp;Admin&nbsp;Site:&nbsp;'$SPOAdminSiteUrl'&nbsp;using&nbsp;account:&quot;</span>&nbsp;<span class="powerShellWorkflow__variable">$PSCred</span>.UserName&nbsp;
&nbsp;Connect<span class="powerShellWorkflow__operator">-</span>SPOService&nbsp;<span class="powerShellWorkflow__operator">-</span>Url&nbsp;<span class="powerShellWorkflow__variable">$SPOAdminSiteUrl</span>&nbsp;<span class="powerShellWorkflow__operator">-</span>Credential&nbsp;<span class="powerShellWorkflow__variable">$PSCred</span>&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;Get<span class="powerShellWorkflow__operator">-</span>SPOSite&nbsp;<span class="powerShellWorkflow__operator">|</span>&nbsp;%&nbsp;{&nbsp;Write<span class="powerShellWorkflow__operator">-</span>Output&nbsp;(<span class="powerShellWorkflow__string">&quot;Site:&quot;</span>&nbsp;<span class="powerShellWorkflow__operator">&#43;</span>&nbsp;<span class="powerShellWorkflow__variable">$_</span>.Url)&nbsp;}&nbsp;&nbsp;&nbsp;
}</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p style="color:#000000; line-height:normal; font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;; font-size:11pt; font-style:normal; font-weight:normal; margin-top:0in; margin-bottom:8pt">
&nbsp;</p>
<p style="color:#000000; line-height:normal; font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;; font-size:11pt; font-style:normal; font-weight:normal; margin-top:0in; margin-bottom:8pt">
<span style="color:black; font-family:&quot;Segoe UI&quot;,&quot;sans-serif&quot;; font-size:9.5pt"><br>
</span></p>

        </div>
    </body>
</html>