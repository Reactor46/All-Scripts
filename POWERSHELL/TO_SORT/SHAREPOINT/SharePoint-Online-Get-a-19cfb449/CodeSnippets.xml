<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="Add-Type -Path &quot;c:\Program Files\Common Files\microsoft shared\Web Server Extensions\15\ISAPI\Microsoft.SharePoint.Client.dll&quot; &#xD;&#xA;Add-Type -Path &quot;c:\Program Files\Common Files\microsoft shared\Web Server Extensions\15\ISAPI\Microsoft.SharePoint.Client.Runtime.dll&quot; &#xD;&#xA;&#xD;&#xA;$siteUrl = “https://mytenant.sharepoint.com/sites/mysitecollection”&#xD;&#xA;$username = &quot;admin@mytenant.onmicrosoft.com&quot;&#xD;&#xA;$password = Read-Host -Prompt &quot;Enter password&quot; -AsSecureString &#xD;&#xA;$ctx = New-Object Microsoft.SharePoint.Client.ClientContext($siteUrl) &#xD;&#xA;$credentials = New-Object Microsoft.SharePoint.Client.SharePointOnlineCredentials($username, $password) &#xD;&#xA;$ctx.Credentials = $credentials&#xD;&#xA;&#xD;&#xA;$rootWeb = $ctx.Web &#xD;&#xA;$sites  = $rootWeb.Webs&#xD;&#xA;&#xD;&#xA;$ctx.Load($rootWeb)&#xD;&#xA;$ctx.Load($sites)&#xD;&#xA;$ctx.ExecuteQuery()&#xD;&#xA;&#xD;&#xA;foreach($site in $sites)&#xD;&#xA;{&#xD;&#xA;    $ctx.Load($site)&#xD;&#xA;    $ctx.ExecuteQuery()&#xD;&#xA;&#xD;&#xA;    Write-Host $site.Title &quot;-&quot; $site.Url &#xD;&#xA;}&#xD;&#xA;" />
  <Code Content="Add-Type -Path &quot;c:\Program Files\Common Files\microsoft shared\Web Server Extensions\15\ISAPI\Microsoft.SharePoint.Client.dll&quot; &#xD;&#xA;Add-Type -Path &quot;c:\Program Files\Common Files\microsoft shared\Web Server Extensions\15\ISAPI\Microsoft.SharePoint.Client.Runtime.dll&quot; &#xD;&#xA;&#xD;&#xA;$siteUrl = “https://mytenant.sharepoint.com/sites/mysitecollection”&#xD;&#xA;$username = &quot;admin@mytenant.onmicrosoft.com&quot;&#xD;&#xA;$password = Read-Host -Prompt &quot;Enter password&quot; -AsSecureString &#xD;&#xA;$ctx = New-Object Microsoft.SharePoint.Client.ClientContext($siteUrl) &#xD;&#xA;$credentials = New-Object Microsoft.SharePoint.Client.SharePointOnlineCredentials($username, $password) &#xD;&#xA;$ctx.Credentials = $credentials&#xD;&#xA;&#xD;&#xA;$rootWeb = $ctx.Web &#xD;&#xA;$sites  = $rootWeb.Webs&#xD;&#xA;&#xD;&#xA;$ctx.Load($rootWeb)&#xD;&#xA;$ctx.Load($sites)&#xD;&#xA;$ctx.ExecuteQuery()&#xD;&#xA;&#xD;&#xA;foreach($site in $sites)&#xD;&#xA;{&#xD;&#xA;    $ctx.Load($site)&#xD;&#xA;    $ctx.ExecuteQuery()&#xD;&#xA;&#xD;&#xA;    Write-Host $site.Title &quot;-&quot; $site.Url &#xD;&#xA;}&#xD;&#xA;" />
</CodeSnippets>