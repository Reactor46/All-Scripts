<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="param (&#xD;&#xA;    [Parameter(Mandatory = $true, `&#xD;&#xA;&#x9;&#x9;ValueFromPipeline = $true)]&#xD;&#xA;    [string]$SiteUrl = &quot;&quot;,&#xD;&#xA;    [Parameter(Mandatory = $true)]&#xD;&#xA;    [string]$GroupName = &quot;&quot;,&#xD;&#xA;    [Parameter(Mandatory = $true)]&#xD;&#xA;    [ValidateSet(&quot;Full Control&quot;,&quot;Design&quot;,`&#xD;&#xA;&#x9;&#x9;&quot;Edit&quot;,&quot;Contribute&quot;,&quot;Read&quot;,&quot;View Only&quot;)]&#xD;&#xA;    [string]$PermissionLevel = &quot;View Only&quot;,&#x9;&#xD;&#xA;    [string]$Description = &quot;&quot;,&#xD;&#xA;    [ValidateSet($true,$false)]&#xD;&#xA;    [string]$OnlyAllowMembersViewMembership = $true,&#xD;&#xA;    [ValidateSet($true,$false)]&#xD;&#xA;    [string]$AllowMembersEditMembership = $false,&#xD;&#xA;    [ValidateSet($true,$false)]&#xD;&#xA;    [string]$AllowRequestToJoinLeave = $false,&#xD;&#xA;    [ValidateSet($true,$false)]&#xD;&#xA;    [string]$AutoAcceptRequestToJoinLeave = $false,&#xD;&#xA;    [System.Net.Mail.MailAddress]$RequestToJoinLeaveEmailSetting &#xD;&#xA;    )&#xD;&#xA;&#xD;&#xA;#Set site url&#xD;&#xA;$web = Get-SPWeb $SiteUrl&#xD;&#xA;&#xD;&#xA;#Create a new group&#xD;&#xA;$web.SiteGroups.Add($GroupName,$web.CurrentUser,$web.CurrentUser,$Description)&#xD;&#xA;&#xD;&#xA;#Customize the group settings&#xD;&#xA;$Group = $web.SiteGroups[$GroupName]&#xD;&#xA;$Group.OnlyAllowMembersViewMembership = $OnlyAllowMembersViewMembership&#xD;&#xA;$Group.AllowMembersEditMembership = $AllowMembersEditMembership&#xD;&#xA;$Group.AllowRequestToJoinLeave = $AllowRequestToJoinLeave&#xD;&#xA;$Group.AutoAcceptRequestToJoinLeave = $AutoAcceptRequestToJoinLeave&#xD;&#xA;$Group.RequestToJoinLeaveEmailSetting = $RequestToJoinLeaveEmailSetting&#xD;&#xA;$Group.Update()&#xD;&#xA;&#xD;&#xA;#Create a new assignment (group and permission level pair)&#xD;&#xA;$GroupAssignment = New-Object Microsoft.SharePoint.SPRoleAssignment($Group)&#xD;&#xA;&#xD;&#xA;#Get the permission levels to apply to the new group&#xD;&#xA;$RoleDefinition = $web.Site.RootWeb.RoleDefinitions[$PermissionLevel]&#xD;&#xA;&#xD;&#xA;#Assign the appropriate permission level to group&#xD;&#xA;$GroupAssignment.RoleDefinitionBindings.Add($RoleDefinition)&#xD;&#xA;&#xD;&#xA;#Add group to the site&#xD;&#xA;$web.RoleAssignments.Add($GroupAssignment)" />
  <Code Content="param (&#xD;&#xA;    [Parameter(Mandatory = $true, `&#xD;&#xA;&#x9;&#x9;ValueFromPipeline = $true)]&#xD;&#xA;    [string]$SiteUrl = &quot;&quot;,&#xD;&#xA;    [Parameter(Mandatory = $true)]&#xD;&#xA;    [string]$GroupName = &quot;&quot;,&#xD;&#xA;    [Parameter(Mandatory = $true)]&#xD;&#xA;    [ValidateSet(&quot;Full Control&quot;,&quot;Design&quot;,`&#xD;&#xA;&#x9;&#x9;&quot;Edit&quot;,&quot;Contribute&quot;,&quot;Read&quot;,&quot;View Only&quot;)]&#xD;&#xA;    [string]$PermissionLevel = &quot;View Only&quot;,&#x9;&#xD;&#xA;    [string]$Description = &quot;&quot;,&#xD;&#xA;    [ValidateSet($true,$false)]&#xD;&#xA;    [string]$OnlyAllowMembersViewMembership = $true,&#xD;&#xA;    [ValidateSet($true,$false)]&#xD;&#xA;    [string]$AllowMembersEditMembership = $false,&#xD;&#xA;    [ValidateSet($true,$false)]&#xD;&#xA;    [string]$AllowRequestToJoinLeave = $false,&#xD;&#xA;    [ValidateSet($true,$false)]&#xD;&#xA;    [string]$AutoAcceptRequestToJoinLeave = $false,&#xD;&#xA;    [System.Net.Mail.MailAddress]$RequestToJoinLeaveEmailSetting &#xD;&#xA;    )&#xD;&#xA;&#xD;&#xA;#Set site url&#xD;&#xA;$web = Get-SPWeb $SiteUrl&#xD;&#xA;&#xD;&#xA;#Create a new group&#xD;&#xA;$web.SiteGroups.Add($GroupName,$web.CurrentUser,$web.CurrentUser,$Description)&#xD;&#xA;&#xD;&#xA;#Customize the group settings&#xD;&#xA;$Group = $web.SiteGroups[$GroupName]&#xD;&#xA;$Group.OnlyAllowMembersViewMembership = $OnlyAllowMembersViewMembership&#xD;&#xA;$Group.AllowMembersEditMembership = $AllowMembersEditMembership&#xD;&#xA;$Group.AllowRequestToJoinLeave = $AllowRequestToJoinLeave&#xD;&#xA;$Group.AutoAcceptRequestToJoinLeave = $AutoAcceptRequestToJoinLeave&#xD;&#xA;$Group.RequestToJoinLeaveEmailSetting = $RequestToJoinLeaveEmailSetting&#xD;&#xA;$Group.Update()&#xD;&#xA;&#xD;&#xA;#Create a new assignment (group and permission level pair)&#xD;&#xA;$GroupAssignment = New-Object Microsoft.SharePoint.SPRoleAssignment($Group)&#xD;&#xA;&#xD;&#xA;#Get the permission levels to apply to the new group&#xD;&#xA;$RoleDefinition = $web.Site.RootWeb.RoleDefinitions[$PermissionLevel]&#xD;&#xA;&#xD;&#xA;#Assign the appropriate permission level to group&#xD;&#xA;$GroupAssignment.RoleDefinitionBindings.Add($RoleDefinition)&#xD;&#xA;&#xD;&#xA;#Add group to the site&#xD;&#xA;$web.RoleAssignments.Add($GroupAssignment)" />
</CodeSnippets>