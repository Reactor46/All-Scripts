# Invoke-WDACSimulation available parameters

![image](https://raw.githubusercontent.com/HotCakeX/.github/main/Pictures/Wiki%20APNGs/Invoke-WDACSimulation/Invoke-WDACSimulation.apng)

```powershell
Invoke-WDACSimulation [-FolderPath] <DirectoryInfo> [-XmlFilePath] <FileInfo> [-SkipVersionCheck]
[<CommonParameters>]
```

<br>

This cmdlet allows you to simulate a WDAC (App Control for Business) policy deployment. Simply select a folder and a policy xml file, it will show you whether the files in the folder would be allowed or blocked by your WDAC policy if it was actually deployed on a system and those files were run.

Upon completion of the simulation, you will obtain a CSV file in the current working directory containing the output of the simulation with exhaustive details of each file that would be blocked/allowed by the selected policy. It will be very useful, specially if the folder that was being scanned had thousands of files.

Currently, this cmdlet is suitable mostly for xml policy files generated by **Level: FilePublisher** and **Fallback: Hash**, [which are actually the safest and best options](https://github.com/HotCakeX/Harden-Windows-Security/wiki/WDAC-Notes#file-rule-levels-security), and are also the defaults used by the WDACConfig module. If the policy was generated by other levels and fallbacks such as filepaths, the output of this cmdlet will not be accurate.

<br>

## Some Use Cases

* Have a WDAC policy and you want to test whether all of the files of a program will be allowed by the policy without running the program first? Use this WDAC simulation to find out.

* Employ this simulation method to discover files that are not explicitly specified in the WDAC policy but are still authorized to run by it. When you scan a folder to create a Supplemental policy for the files inside it, some files might not require to be mentioned in the xml policy file because they are already sanctioned using their certificate details by other files, so it would not be possible to check their availability merely by examining the XML file. Using this simulation, you will be able to confirm their eligibility and whether or not they are permitted by the WDAC policy, using robust automated methods of verification.

* Identify files that have hash mismatch and will not be permitted by WDAC engine using signature. These files are typically found in [*questionable* software](https://github.com/HotCakeX/Harden-Windows-Security/wiki/WDAC-Notes#allowing-questionable-software-in-a-wdac-policy) because they are tampered with. They are still incorporated into the WDAC policy based on their certificate signature but when you execute them you will receive a blocked message. Use this WDAC simulation feature to detect them without running them first.

* And more.

<br>

### 2 Mandatory Parameters

* `-FolderPath <string>`: Path to a folder. Supports argument tab completion, select the parameter then press TAB to open the Folder picker GUI.

* `-XmlFilePath <string>`: Path to a xml file. Supports argument tab completion, select the parameter then press TAB to open the file picker GUI that only shows xml files.

<br>

<img src="https://github.com/HotCakeX/Harden-Windows-Security/raw/main/images/Gifs/1pxRainbowLine.gif" width= "300000" alt="horizontal super thin rainbow RGB line">

<br>

## Notes

* **Mandatory** parameters indicate you always need to provide values for them.

* **Automatic** parameters indicate that if you used [Set-CommonWDACConfig](https://github.com/HotCakeX/Harden-Windows-Security/wiki/Set-CommonWDACConfig) cmdlet to set default values for them, the module will automatically use them. This saves time and prevents repetitive tasks. However, if no value exists in User Configurations for an Automatic parameter and you didn't explicitly provide a value for that parameter either, then you will see an error asking you to provide value for it. Explicitly providing a value for an Automatic parameter in the command line overrides its default value in User Configurations, meaning the module will ignore the value of the same parameter in the User Configurations file.

* **Optional** parameters indicate that they are not required and without using them the module will automatically run with the optimal settings.

* A small part of this cmdlet's code includes [Vadims PodƒÅns's](https://www.sysadmins.lv/disclaimer.aspx) code for [nested certificate calculation](https://www.sysadmins.lv/blog-en/reading-multiple-signatures-from-signed-file-with-powershell.aspx) of double signed files.

<br>
