# Define the list of GUIDs to search for
$guids = @(
    "{3691148D-EF42-4812-8956-AE11FC413B8D}",
"{39D629D6-3EC3-4F20-B994-BFECCAB6A2BC}",
"{91B168E5-74C0-4883-9A2F-7F1E19BEB9AF}",
"{FCB5E8E0-C690-32BD-8A75-A5FC57742D2F}",
"{972C39FB-1CBF-4578-AA47-311682971CCC}",
"{2183D206-25A6-4950-B224-F5873482A3DF}",
"{8DC3342B-F96C-4CB2-81FE-CFCA1F19FA25}",
"{DE5C6454-AFC4-485A-A6C9-ACAAD3D75E10}",
"{CEB672C4-D459-43C5-8A41-5802B125D74C}",
"{FACBFC45-D8A0-40EA-9144-3AA94DBBDA82}",
"{CC1A689D-052A-45FF-8597-20F1EA41D316}",
"{EC38B47E-AD87-4203-8AF4-5415A8C31711}",
"{03171E2B-59AB-46A3-9084-23E51C0D2010}",
"{727CF86D-4100-467F-BE93-AF8A937D9F97}",
"{8ECD9126-5C60-4E70-92C8-E46D4851DD0C}",
"{AA519709-E672-451E-83CC-75685E2280D7}",
"{5929D0F6-906C-4C36-A238-A3679AD5EDDA}",
"{5EDC94B6-65F8-4F72-AB3A-A212831DC852}",
"{A9F05F28-9FB8-4F3E-807D-45D697531506}",
"{40937164-2C89-439F-B3AC-1D1D5D07F68F}",
"{1BC68372-48BE-4164-ABB6-F0288F02395F}",
"{06255994-F4AD-436B-B948-2401D8303E1B}",
"{BF09DF51-9465-4F2D-A033-9E33591E6A4A}",
"{8A2B2B50-3A95-4413-B51B-6E6648047A82}",
"{C25DB92E-331C-420E-AC6A-EF6F337AAFA8}",
"{3B7BBBE3-9BDC-4F17-AFD9-0175520FD76E}",
"{5A480FE9-389E-43B5-8760-74A21CFE7BFB}",
"{17F5F7DB-6429-4DAB-B427-E964853AF4B0}",
"{381A6531-6B67-4F82-881C-02A5A6DB0A64}",
"{9C91AE94-81AB-4A5F-8B95-FB1478450EC6}",
"{6B7E3789-27EB-42C2-8954-20D0FCF9BAD9}",
"{01081DE2-00A3-48A9-8958-CDC543D8EF42}",
"{03171181-C838-4C5C-8615-BFAFAC6E19B0}",
"{1FD78CEC-391C-4D5D-9A4A-5635FE10F44F}",
"{C354254E-2323-4B56-988D-735CA98198FE}",
"{B86995FA-1A44-4097-AC44-0260720C282A}",
"{13ACDBCB-2385-4D84-9CEE-2A37C7E3DA91}",
"{9245BB2A-DDFE-4B50-BD96-74676A97C677}",
"{116BB497-6EF9-40D5-8169-399FA8C44F05}",
"{6C547448-603E-4A32-B7FC-6BB78CFCC728}",
"{BD4F6F6A-88EB-4466-8F69-EA7897FA5EDD}",
"{C3D63CFE-8AF5-4177-A29F-94322FE7D881}",
"{D1FDB7C2-3EAA-44B8-B567-30434F6376BD}",
"{D9390C57-CF11-42AC-B684-F5F833D83D89}",
"{DCFE6F85-5241-4BCC-9B50-0816DE2F6ED4}",
"{66CBA69D-480E-4879-8498-3279A1C548BB}",
"{A93C4E12-1BAB-4CFB-ADBC-9CE0B93176FF}",
"{EBD44C5E-F1AF-4955-AEDF-F15D06384A9C}",
"{995CC82C-E3E8-4BB5-9AB8-2B95C611D59D}",
"{D81A418F-966D-4069-B3E8-5EE4843CA862}",
"{2A367180-D4CC-4957-9FB8-DC73B5973A66}",
"{51701D62-C986-4508-B423-5EFE6FF708B7}",
"{61373008-0285-40B8-93C2-26C8110BC4ED}",
"{3C3CA326-3F1D-43B7-B0AD-CBC06B2DED5A}",
"{56205076-5F5F-408B-A2CC-EF72BFFBC6DD}",
"{FD10B803-97FD-4867-9753-8784BC35D2F8}",
"{84E57A75-AA9E-4DF6-ABDD-2BBB466C197D}",
"{A2A39CB9-677D-4299-8537-C00B99F3D4A4}",
"{98CA5A6B-4ECC-4E6D-BF18-6B20CBB6E5F4}",
"{C3DD1448-513A-4DB8-978D-6991562EA63D}",
"{94EE74AD-4205-4038-8748-000D966FA407}",
"{1BF67DC1-8BB5-4AF5-BE20-3B53D9532D01}",
"{9214708B-E625-4F9A-AA0B-802B7C1DDB73}",
"{368BE572-D3CE-47B6-A3B1-DE0270E5C109}",
"{49F8F20C-72C0-4027-B1C2-097AAC6F2815}",
"{7C0437DA-6703-47F1-A116-CD138B0768AD}",
"{1A02C1B1-05BB-49F7-9DFF-99A66C6877FC}",
"{A40FC77D-3234-41D7-9FF8-2B1CA7F30715}",
"{07BE9B02-0247-471C-B06F-A3B1A8FA9216}",
"{E5F13F9F-49F6-418F-B6ED-D1F37350FDC1}",
"{BA6DD641-C766-473C-B70A-451F96F4D88B}",
"{8075C447-DEF3-4DCC-BB39-8497717BE91E}",
"{7CEA3ABF-FE24-42AF-ADE6-B4A3EE346743}",
"{4368217D-0EEE-4612-973D-CB228B37F17A}",
"{0B4F742D-2D47-4E95-B756-402822D31C48}",
"{096A34D3-C29C-4464-9B91-5EF8EFC6A0BD}",
"{6A35BBB9-7DC9-48E8-B3A8-F48BE041171A}",
"{861CC9D1-8A1A-4FAA-9339-5975FD176781}",
"{6B721A5A-9654-4FB2-82B6-2F07BD95BC1B}",
"{4F26CBC5-A7DA-4726-B565-F4A68E8F1ADD}",
"{0973B714-6575-497F-97E2-6B1D24D7086E}",
"{A721F6FD-9ED5-4D0A-9D14-FB1F7E97D24F}",
"{C2888160-41D8-45A4-98A4-20E19DB684B9}",
"{83061AFE-C311-4DF8-977E-1A94A985D920}",
"{D12C4399-F7EE-4105-A34A-D8DCC7C81A3A}",
"{3CD8C56A-7D87-4641-B060-461C470FC322}",
"{3B2846C7-FA2A-49C9-B16E-984808880569}",
"{CF54285A-495C-4FD1-8D58-9BAAC2072CCB}",
"{45C54C83-71BF-4D40-A06A-A4D56DBFB492}",
"{336FE300-4E1A-4A3C-98F1-794977FB08FE}",
"{FE63330E-ED15-3B1D-B577-06106A457D1D}",
"{9F022488-5C33-39A1-B714-3CB21E167467}",
"{4A34BC3F-E0C3-3BFF-9379-4F3F611AC617}",
"{15FF6229-E3FA-324F-B7BC-855ADE2E4000}",
"{EB4AA7BF-1E27-33BB-91BC-1FD67B340EB0}",
"{C75E0CB7-F988-3754-9422-3E64DA05721B}",
"{E885BD5D-F55D-39C2-B9B5-BF52B030982F}",
"{AF385E74-B641-351B-BC1F-4B33151DEFB2}",
"{8B4592F0-5177-3D50-8664-706443E12DE6}",
"{ED755FBF-3CAE-3206-A32D-16E67F7CC9A3}",
"{764E0466-4783-3C09-9218-D220E568EF0E}",
"{1F3CA9A1-1374-36AB-AA52-0F3A14F18A24}",
"{36CB0F53-A98E-36D1-B1D8-3C1625F579EF}",
"{E1C33E3B-5E1D-3408-BB41-01E6D48022F9}",
"{2AFD77B1-2D50-3C97-9355-1A6DFE55A31A}",
"{999441BF-4BB0-315C-AD06-6F04034B8E6B}",
"{A832CFC9-1DE7-342A-9189-4B1387B7A784}",
"{929B72A6-5EDA-3194-B105-A93E7D299715}",
"{FA97D589-B37E-3B49-A8D2-4764029773FE}",
"{62EE6C16-07EE-3A8D-A533-F3057F965F5E}",
"{1C5B2A67-5828-33F9-9FB3-BE5780644781}",
"{4A56B2C5-94A0-35BE-9069-AD1902B2DB1C}",
"{898EF221-8A33-33BD-93CC-8185E8D59F3F}",
"{6206115B-95DE-37B6-8A63-B5B47592AC13}",
"{4456FDE5-AAE9-4E03-9B34-0D9A476CEF5A}",
"{32D405E8-E1B0-4E1D-BCFF-B9FE5AB15F7E}",
"{258184C9-1C62-47DB-9CA2-7BB24E9145C0}",
"{5C2CD55C-E0A6-4D5C-A7C4-FFC397A6B7F8}",
"{3EC7701F-54F2-491D-AFD1-0395F465BC5A}",
"{0F3E4057-E2BB-4114-A646-F143DB5CE4C9}",
"{A39D4115-3A27-4245-AE92-3214B8B21932}",
"{E414058D-38CD-42D0-9050-C8C13E7EE911}",
"{3E726676-B5F4-48DA-B9F9-78A15B7F8A70}",
"{AC216B9B-DF75-41FE-AF22-0AC2272485D5}",
"{B353ABAB-7F7C-4605-852D-0E5C3E1FA289}",
"{12F9392A-C328-484C-98DA-9621CEC93FFF}",
"{AA393199-374C-4AD1-9245-6CBB254D8146}",
"{1F0EB53C-BE30-436A-BC54-FA364227A870}",
"{7AA89A3B-EFD3-4E74-A24C-A0C5F77B2830}",
"{A59F43A6-AADB-42EB-883B-2FE4E3AA3A69}",
"{9B2DADBD-59B7-412C-9043-6FA553AAB0FB}",
"{A0EC4CD9-836A-4D8B-BBD7-D5BC3902465C}",
"{EB3983F9-3D60-456D-A11A-C1366C79AD3E}",
"{2EA86F1A-CE4C-4696-8B6A-556D46294B2D}",
"{C1CD2FC1-92E6-4DE2-89D8-6D309881856F}",
"{AB3B1EE8-9C44-4154-B8CC-58E8D7B8D8FE}",
"{472040E7-C5D7-4D74-B992-DD28BBE5D610}",
"{0128408E-205B-44B9-BEBD-E5B7A0E450F4}",
"{B6990776-0EA4-4DC9-9017-A39A120D1C40}",
"{A7ED0445-8A35-4A62-8B52-394D54A075B8}",
"{4E61286A-B95A-4FCC-85AA-D4C7A9AEB5EF}",
"{5CF4E75C-03D0-445A-8ADD-6EB0FE4B4648}",
"{B74D30E1-7B46-409F-B984-FD49EF9B2B8F}",
"{C1D44B58-844F-40D8-9C84-377E83D629B4}",
"{939D4E60-912A-4D02-BA11-EC9B4B9FAE92}",
"{12F9392A-C328-484C-98DA-9621CEC93FFF}",
"{0B4F742D-2D47-4E95-B756-402822D31C48}",
"{15FF6229-E3FA-324F-B7BC-855ADE2E4000}",
"{17F5F7DB-6429-4DAB-B427-E964853AF4B0}",
"{1A02C1B1-05BB-49F7-9DFF-99A66C6877FC}",
"{1BC68372-48BE-4164-ABB6-F0288F02395F}",
"{1BF67DC1-8BB5-4AF5-BE20-3B53D9532D01}",
"{1F0EB53C-BE30-436A-BC54-FA364227A870}",
"{1FD78CEC-391C-4D5D-9A4A-5635FE10F44F}",
"{368BE572-D3CE-47B6-A3B1-DE0270E5C109}",
"{381A6531-6B67-4F82-881C-02A5A6DB0A64}",
"{3B7BBBE3-9BDC-4F17-AFD9-0175520FD76E}",
"{40937164-2C89-439F-B3AC-1D1D5D07F68F}",
"{472040E7-C5D7-4D74-B992-DD28BBE5D610}",
"{4A34BC3F-E0C3-3BFF-9379-4F3F611AC617}",
"{4A56B2C5-94A0-35BE-9069-AD1902B2DB1C}",
"{5A480FE9-389E-43B5-8760-74A21CFE7BFB}",
"{5EDC94B6-65F8-4F72-AB3A-A212831DC852}",
"{6A35BBB9-7DC9-48E8-B3A8-F48BE041171A}",
"{6B721A5A-9654-4FB2-82B6-2F07BD95BC1B}",
"{764E0466-4783-3C09-9218-D220E568EF0E}",
"{83061AFE-C311-4DF8-977E-1A94A985D920}",
"{929B72A6-5EDA-3194-B105-A93E7D299715}",
"{A0EC4CD9-836A-4D8B-BBD7-D5BC3902465C}",
"{A39D4115-3A27-4245-AE92-3214B8B21932}",
"{A832CFC9-1DE7-342A-9189-4B1387B7A784}",
"{A9F05F28-9FB8-4F3E-807D-45D697531506}",
"{B353ABAB-7F7C-4605-852D-0E5C3E1FA289}",
"{B6990776-0EA4-4DC9-9017-A39A120D1C40}",
"{B86995FA-1A44-4097-AC44-0260720C282A}",
"{BA6DD641-C766-473C-B70A-451F96F4D88B}",
"{C3DD1448-513A-4DB8-978D-6991562EA63D}",
"{D81A418F-966D-4069-B3E8-5EE4843CA862}",
"{EC38B47E-AD87-4203-8AF4-5415A8C31711}",
"{258184C9-1C62-47DB-9CA2-7BB24E9145C0}",
"{112516EB-23D5-4F3A-AD7B-3AB68DC30E72}",
"{4456FDE5-AAE9-4E03-9B34-0D9A476CEF5A}",
"{5673D71A-7C3A-3C2E-BF77-EA4890864EE4}",
"{643977DC-2D85-4198-B73B-D287098396F8}",
"{81EDF4A0-FC57-48C3-B26A-E90C2DC266CE}",
"{832FC239-AE54-4957-AFC3-67A723C2883C}",
"{B0D52F62-1A2D-4023-8799-E8554E7E913E}",
"{C4861E70-857D-455B-8277-B8AC0497CC19}",
"{32D405E8-E1B0-4E1D-BCFF-B9FE5AB15F7E}",
"{5C2CD55C-E0A6-4D5C-A7C4-FFC397A6B7F8}",
"{BF9694C8-23BA-3602-991A-1008206AB753}",
"{BFF01263-80DA-4A54-A1C6-645476687AC5}",
"{E40BC6AB-5820-4457-A2B9-2C628F8C7BFA}",
"{99E0DD5A-185F-4F65-8239-ED65182A15AF}"
)

# Define registry paths to check
$registryPaths = @(
    "HKCU:\Software\Microsoft\Windows\CurrentVersion\Uninstall",
    "HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall",
    "HKLM:\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall"
)

# Prepare the report structure
$report = @"
<html>
<head>
    <style>
        body { font-family: Arial, sans-serif; }
        .header { color: #2E86C1; font-size: 24px; text-align: center; padding: 10px; }
        .content { font-size: 16px; color: #333; padding: 15px; }
        .success { color: green; }
        .warning { color: orange; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div class="header">Uninstall GUID Report</div>
    <div class="content">
"@

# Iterate through the list of GUIDs and search registry paths
foreach ($guid in $guids) {
    $found = $false

    # Iterate through registry paths to search for each GUID
    foreach ($path in $registryPaths) {
        Get-ChildItem -Path $path | ForEach-Object {
            $key = $_
            if ($key.GetValueNames() -contains "UninstallString") {
                $uninstallString = $key.GetValue("UninstallString")
                
                # Check if the uninstall string contains the current GUID
                if ($uninstallString -like "*$guid*") {
                    $appName = $key.GetValue("DisplayName")
                    
                    # Create the report if the GUID is found
                    $found = $true
                    $report += "<p class='success'>Found uninstall entry for application: <strong>$appName</strong> (GUID: $guid)</p>"
                    $report += "<p class='warning'>Uninstall is currently running for: <strong>$appName</strong></p>"
                    $report += "<table><tr><th>Application Name</th><th>Uninstall Command</th><th>GUID</th></tr>"
                    $report += "<tr><td>$appName</td><td>$uninstallString</td><td>$guid</td></tr></table>"
                }
            }
        }
    }

    # If GUID not found, report that it's missing
    if (-not $found) {
        $report += "<p class='failure'>Uninstall GUID not found: <strong>$guid</strong></p>"
    }
}

# Finalize and save the HTML report
$report += @"
    </div>
</body>
</html>
"@

# Save the report to an HTML file
$reportPath = "D:\UninstallReport.html"
$report | Out-File -FilePath $reportPath

# Inform the user
Write-Host "Report saved to: $reportPath"
