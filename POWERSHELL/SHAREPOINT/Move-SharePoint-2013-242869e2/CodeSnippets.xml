<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="#-----------------------------------------------------------------------------&#xD;&#xA;# Name:           &#x9;Move-SPEnterpriseSearchIndex.ps1 &#xD;&#xA;# Description:     &#x9;This script will move the SharePoint 2013 Search Index&#xD;&#xA;#&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;# Usage:        &#x9;Run the function with the 3 required Parameters&#xD;&#xA;# By:             &#x9;Ivan Josipovic, Softlanding.ca &#xD;&#xA;#-----------------------------------------------------------------------------&#xD;&#xA;function Move-SPEnterpriseSearchIndex($SearchServiceName,$Server,$IndexLocation){&#xD;&#xA;&#x9;Add-PSSnapin Microsoft.SharePoint.PowerShell -ea 0;&#xD;&#xA;&#x9;#Gets the Search Service Application&#xD;&#xA;&#x9;$SSA = Get-SPServiceApplication -Name $SearchServiceName;&#xD;&#xA;&#x9;if (!$?){throw &quot;Cant find a Search Service Application: `&quot;$SearchServiceName`&quot;&quot;;}&#xD;&#xA;&#x9;#Gets the Search Service Instance on the Specified Server&#xD;&#xA;&#x9;$Instance = Get-SPEnterpriseSearchServiceInstance -Identity $Server;&#xD;&#xA;&#x9;if (!$?){throw &quot;Cant find a Search Service Instance on Server: `&quot;$Server`&quot;&quot;;}&#xD;&#xA;&#x9;#Gets the current Search Topology&#xD;&#xA;&#x9;$Current = Get-SPEnterpriseSearchTopology -SearchApplication $SSA -Active;&#xD;&#xA;&#x9;if (!$?){throw &quot;There is no Active Topology, you can try removing the `&quot;-Active`&quot; from the line above in the script&quot;;}&#xD;&#xA;&#x9;#Creates a Copy of the current Search Topology&#xD;&#xA;&#x9;$Clone = New-SPEnterpriseSearchTopology -Clone -SearchApplication $SSA -SearchTopology $Current;&#xD;&#xA;&#x9;#Adds a new Index Component with the new Index Location&#xD;&#xA;&#x9;New-SPEnterpriseSearchIndexComponent -SearchTopology $Clone -IndexPartition 0 -SearchServiceInstance $Instance -RootDirectory $IndexLocation | Out-Null;&#xD;&#xA;&#x9;if (!$?){throw &quot;Make sure that Index Location `&quot;$IndexLocation`&quot; exists on Server: `&quot;$Server`&quot;&quot;;}&#xD;&#xA;&#x9;#Sets our new Search Topology as Active&#xD;&#xA;&#x9;Set-SPEnterpriseSearchTopology -Identity $Clone;&#xD;&#xA;&#x9;#Removes the old Search Topology&#xD;&#xA;&#x9;Remove-SPEnterpriseSearchTopology -Identity $Current -Confirm:$false;&#xD;&#xA;&#x9;#Now we need to remove the extra Index Component&#xD;&#xA;&#x9;#Gets the Search Topology&#xD;&#xA;&#x9;$Current = Get-SPEnterpriseSearchTopology -SearchApplication $SSA -Active;&#xD;&#xA;&#x9;#Creates a copy of the current Search Topology&#xD;&#xA;&#x9;$Clone=New-SPEnterpriseSearchTopology -Clone -SearchApplication $SSA -SearchTopology $Current;&#xD;&#xA;&#x9;#Removes the old Index Component from the Search Topology&#xD;&#xA;&#x9;Get-SPEnterpriseSearchComponent -SearchTopology $Clone | ? {($_.GetType().Name -eq &quot;IndexComponent&quot;) -and ($_.ServerName -eq $($Instance.Server.Address)) -and ($_.RootDirectory -ne $IndexLocation)} | Remove-SPEnterpriseSearchComponent -SearchTopology $Clone -Confirm:$false;&#xD;&#xA;&#x9;#Sets our new Search Topology as Active&#xD;&#xA;&#x9;Set-SPEnterpriseSearchTopology -Identity $Clone;&#xD;&#xA;&#x9;#Removes the old Search Topology&#xD;&#xA;&#x9;Remove-SPEnterpriseSearchTopology -Identity $Current -Confirm:$False;&#xD;&#xA;&#x9;Write-Host &quot;The Index has been moved to $IndexLocation on $Server&quot;&#xD;&#xA;&#x9;Write-Host &quot;This will not remove the data from the old index location. You will have to do that manually :)&quot;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;Move-SPEnterpriseSearchIndex -SearchServiceName &quot;Search Service Application&quot; -Server &quot;SP2013-WFE&quot; -IndexLocation &quot;C:\Index&quot;" />
  <Code Content="#-----------------------------------------------------------------------------&#xD;&#xA;# Name:           &#x9;Move-SPEnterpriseSearchIndex.ps1 &#xD;&#xA;# Description:     &#x9;This script will move the SharePoint 2013 Search Index&#xD;&#xA;#&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;# Usage:        &#x9;Run the function with the 3 required Parameters&#xD;&#xA;# By:             &#x9;Ivan Josipovic, Softlanding.ca &#xD;&#xA;#-----------------------------------------------------------------------------&#xD;&#xA;function Move-SPEnterpriseSearchIndex($SearchServiceName,$Server,$IndexLocation){&#xD;&#xA;&#x9;Add-PSSnapin Microsoft.SharePoint.PowerShell -ea 0;&#xD;&#xA;&#x9;#Gets the Search Service Application&#xD;&#xA;&#x9;$SSA = Get-SPServiceApplication -Name $SearchServiceName;&#xD;&#xA;&#x9;if (!$?){throw &quot;Cant find a Search Service Application: `&quot;$SearchServiceName`&quot;&quot;;}&#xD;&#xA;&#x9;#Gets the Search Service Instance on the Specified Server&#xD;&#xA;&#x9;$Instance = Get-SPEnterpriseSearchServiceInstance -Identity $Server;&#xD;&#xA;&#x9;if (!$?){throw &quot;Cant find a Search Service Instance on Server: `&quot;$Server`&quot;&quot;;}&#xD;&#xA;&#x9;#Gets the current Search Topology&#xD;&#xA;&#x9;$Current = Get-SPEnterpriseSearchTopology -SearchApplication $SSA -Active;&#xD;&#xA;&#x9;if (!$?){throw &quot;There is no Active Topology, you can try removing the `&quot;-Active`&quot; from the line above in the script&quot;;}&#xD;&#xA;&#x9;#Creates a Copy of the current Search Topology&#xD;&#xA;&#x9;$Clone = New-SPEnterpriseSearchTopology -Clone -SearchApplication $SSA -SearchTopology $Current;&#xD;&#xA;&#x9;#Adds a new Index Component with the new Index Location&#xD;&#xA;&#x9;New-SPEnterpriseSearchIndexComponent -SearchTopology $Clone -IndexPartition 0 -SearchServiceInstance $Instance -RootDirectory $IndexLocation | Out-Null;&#xD;&#xA;&#x9;if (!$?){throw &quot;Make sure that Index Location `&quot;$IndexLocation`&quot; exists on Server: `&quot;$Server`&quot;&quot;;}&#xD;&#xA;&#x9;#Sets our new Search Topology as Active&#xD;&#xA;&#x9;Set-SPEnterpriseSearchTopology -Identity $Clone;&#xD;&#xA;&#x9;#Removes the old Search Topology&#xD;&#xA;&#x9;Remove-SPEnterpriseSearchTopology -Identity $Current -Confirm:$false;&#xD;&#xA;&#x9;#Now we need to remove the extra Index Component&#xD;&#xA;&#x9;#Gets the Search Topology&#xD;&#xA;&#x9;$Current = Get-SPEnterpriseSearchTopology -SearchApplication $SSA -Active;&#xD;&#xA;&#x9;#Creates a copy of the current Search Topology&#xD;&#xA;&#x9;$Clone=New-SPEnterpriseSearchTopology -Clone -SearchApplication $SSA -SearchTopology $Current;&#xD;&#xA;&#x9;#Removes the old Index Component from the Search Topology&#xD;&#xA;&#x9;Get-SPEnterpriseSearchComponent -SearchTopology $Clone | ? {($_.GetType().Name -eq &quot;IndexComponent&quot;) -and ($_.ServerName -eq $($Instance.Server.Address)) -and ($_.RootDirectory -ne $IndexLocation)} | Remove-SPEnterpriseSearchComponent -SearchTopology $Clone -Confirm:$false;&#xD;&#xA;&#x9;#Sets our new Search Topology as Active&#xD;&#xA;&#x9;Set-SPEnterpriseSearchTopology -Identity $Clone;&#xD;&#xA;&#x9;#Removes the old Search Topology&#xD;&#xA;&#x9;Remove-SPEnterpriseSearchTopology -Identity $Current -Confirm:$False;&#xD;&#xA;&#x9;Write-Host &quot;The Index has been moved to $IndexLocation on $Server&quot;&#xD;&#xA;&#x9;Write-Host &quot;This will not remove the data from the old index location. You will have to do that manually :)&quot;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;Move-SPEnterpriseSearchIndex -SearchServiceName &quot;Search Service Application&quot; -Server &quot;SP2013-WFE&quot; -IndexLocation &quot;C:\Index&quot;" />
</CodeSnippets>