<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="function GetSPWebUsers($SiteCollectionURL)&#xD;&#xA;{&#xD;&#xA;    [System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint&quot;) &gt; $null&#xD;&#xA;    $site = new-object Microsoft.SharePoint.SPSite($SiteCollectionURL)&#xD;&#xA;    $web = $site.openweb()&#xD;&#xA;    $siteUsers = $web.SiteUsers&#xD;&#xA;&#xD;&#xA;    foreach($user in $siteUsers)&#xD;&#xA;    {       &#xD;&#xA;        Write-Host &quot; ------------------------------------- &quot;&#xD;&#xA;        Write-Host &quot;Site Collection URL:&quot;, $SiteCollectionURL&#xD;&#xA;        if($user.IsSiteAdmin -eq $true)&#xD;&#xA;        {&#xD;&#xA;            Write-Host &quot;ADMIN: &quot;, $user.LoginName&#xD;&#xA;        }&#xD;&#xA;        else&#xD;&#xA;        {&#xD;&#xA;            Write-Host &quot;USER: &quot;, $user.LoginName&#xD;&#xA;        }&#xD;&#xA;        Write-Host &quot; ------------------------------------- &quot;&#xD;&#xA;    }   &#xD;&#xA;    $web.Dispose()&#xD;&#xA;    $site.Dispose()&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;" />
  <Code Content="function GetSPAllSPUsers($SiteCollectionURL,$SPListName)&#xD;&#xA;{&#xD;&#xA;    [System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint&quot;) &gt; $null&#xD;&#xA;    $site = new-object Microsoft.SharePoint.SPSite($SiteCollectionURL)&#x9;&#xD;&#xA;    $web = $site.openweb()&#xD;&#xA;    $list = $web.Lists[$SPListName]&#xD;&#xA;    $siteCollUsers = $web.SiteUsers&#xD;&#xA;    &#xD;&#xA;    foreach($user in $siteCollUsers)&#xD;&#xA;&#x9;    {&#xD;&#xA;&#x9;&#x9;    Write-Host &quot; ------------------------------------- &quot;&#xD;&#xA;&#x9;&#x9;    Write-Host &quot;Site Collection URL:&quot;, $SiteCollectionURL&#xD;&#xA;            if($list.DoesUserHavePermissions([Microsoft.SharePoint.SPBasePermissions]::ViewListItems,$user) -eq $true)&#xD;&#xA;                {&#xD;&#xA;                    Write-Host &quot;User : &quot;, $user.LoginName&#xD;&#xA;                    Write-Host &quot;Assigned Permissions : &quot;, $list.GetUserEffectivePermissions($user.LoginName)&#xD;&#xA;                }&#x9;&#x9;&#x9;&#xD;&#xA;            Write-Host &quot; ------------------------------------- &quot;&#x9;&#x9;&#xD;&#xA;&#x9;    }&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;    $web.Dispose()&#xD;&#xA;&#x9;    $site.Dispose()&#xD;&#xA; }&#xD;&#xA;" />
  <Code Content="GetSPWebUsers &quot;http://SP2013&quot;&#xD;&#xA;GetSPAllSPUsers &quot;http://sp2013:1111&quot; &quot;List Name&quot;" />
  <Code Content="function GetSPWebUsers($SiteCollectionURL)&#xD;&#xA;{&#xD;&#xA;    [System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint&quot;) &gt; $null&#xD;&#xA;    $site = new-object Microsoft.SharePoint.SPSite($SiteCollectionURL)&#xD;&#xA;    $web = $site.openweb()&#xD;&#xA;    $siteUsers = $web.SiteUsers&#xD;&#xA;&#xD;&#xA;    foreach($user in $siteUsers)&#xD;&#xA;    {       &#xD;&#xA;        Write-Host &quot; ------------------------------------- &quot;&#xD;&#xA;        Write-Host &quot;Site Collection URL:&quot;, $SiteCollectionURL&#xD;&#xA;        if($user.IsSiteAdmin -eq $true)&#xD;&#xA;        {&#xD;&#xA;            Write-Host &quot;ADMIN: &quot;, $user.LoginName&#xD;&#xA;        }&#xD;&#xA;        else&#xD;&#xA;        {&#xD;&#xA;            Write-Host &quot;USER: &quot;, $user.LoginName&#xD;&#xA;        }&#xD;&#xA;        Write-Host &quot; ------------------------------------- &quot;&#xD;&#xA;    }   &#xD;&#xA;    $web.Dispose()&#xD;&#xA;    $site.Dispose()&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;" />
  <Code Content="function GetSPAllSPUsers($SiteCollectionURL,$SPListName)&#xD;&#xA;{&#xD;&#xA;    [System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint&quot;) &gt; $null&#xD;&#xA;    $site = new-object Microsoft.SharePoint.SPSite($SiteCollectionURL)&#x9;&#xD;&#xA;    $web = $site.openweb()&#xD;&#xA;    $list = $web.Lists[$SPListName]&#xD;&#xA;    $siteCollUsers = $web.SiteUsers&#xD;&#xA;    &#xD;&#xA;    foreach($user in $siteCollUsers)&#xD;&#xA;&#x9;    {&#xD;&#xA;&#x9;&#x9;    Write-Host &quot; ------------------------------------- &quot;&#xD;&#xA;&#x9;&#x9;    Write-Host &quot;Site Collection URL:&quot;, $SiteCollectionURL&#xD;&#xA;            if($list.DoesUserHavePermissions([Microsoft.SharePoint.SPBasePermissions]::ViewListItems,$user) -eq $true)&#xD;&#xA;                {&#xD;&#xA;                    Write-Host &quot;User : &quot;, $user.LoginName&#xD;&#xA;                    Write-Host &quot;Assigned Permissions : &quot;, $list.GetUserEffectivePermissions($user.LoginName)&#xD;&#xA;                }&#x9;&#x9;&#x9;&#xD;&#xA;            Write-Host &quot; ------------------------------------- &quot;&#x9;&#x9;&#xD;&#xA;&#x9;    }&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;    $web.Dispose()&#xD;&#xA;&#x9;    $site.Dispose()&#xD;&#xA; }&#xD;&#xA;" />
  <Code Content="GetSPWebUsers &quot;http://SP2013&quot;&#xD;&#xA;GetSPAllSPUsers &quot;http://sp2013:1111&quot; &quot;List Name&quot;" />
</CodeSnippets>