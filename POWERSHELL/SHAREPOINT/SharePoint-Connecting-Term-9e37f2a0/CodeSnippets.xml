<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="$snapin = Get-PSSnapin | Where-Object {$_.Name -eq 'Microsoft.SharePoint.Powershell'} &#xD;&#xA;if ($snapin -eq $null) &#xD;&#xA;{    &#xD;&#xA;&#x9;Write-Host &quot;Loading SharePoint Powershell Snapin&quot;    &#xD;&#xA;&#x9;Add-PSSnapin &quot;Microsoft.SharePoint.Powershell&quot; &#xD;&#xA;}&#xD;&#xA;#Name of MMS Proxy&#xD;&#xA;$mmsServiceName = &quot;Metadata Service Application Proxy&quot;&#xD;&#xA;#Name of Group&#xD;&#xA;$grpName = &quot;CustomGroup&quot;&#xD;&#xA; &#xD;&#xA;[xml]$xmlinput =  (get-content .\Config.xml)&#xD;&#xA;&#xD;&#xA;$item = $xmlinput.Config&#xD;&#xA;$WebApplications = $item.WebApplications&#xD;&#xA;foreach($WebApplication in $WebApplications.WebApplication)&#xD;&#xA;{&#xD;&#xA;&#xD;&#xA;&#x9;#iterates though all the site collections &#xD;&#xA;&#x9;$Mywebapplication = Get-SPWebApplication $WebApplication.url&#xD;&#xA;&#x9;#$Mywebapplication.FormDigestSettings.Enabled = $false&#xD;&#xA;&#x9;foreach($site in $Mywebapplication.Sites)&#xD;&#xA;&#x9;{&#xD;&#xA;&#x9;&#x9;#Declaring the Name of the Term Set and Metadata Columns, it is the same in both cases.&#xD;&#xA;&#x9;&#x9;$customContentTypesArray = @(&quot;Country&quot;, &quot;City&quot;, &quot;County&quot;, &quot;Province&quot;)&#xD;&#xA;&#x9;&#x9;Write-Host &quot;In the Site Collection&quot; $site.url&#xD;&#xA;&#x9;&#x9;foreach ($taxonomy in $customContentTypesArray) &#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;$spweb = $site.RootWeb&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;$session = new-object Microsoft.SharePoint.Taxonomy.TaxonomySession($site)&#xD;&#xA;&#x9;&#x9;&#x9;$termStore = $Session.TermStores[$mmsServiceName];&#xD;&#xA;&#x9;&#x9;&#x9;$group=$termStore.Groups[$grpName]&#xD;&#xA;&#x9;&#x9;&#x9;$termSet = $group.TermSets[$taxonomy]&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;$targetField = [Microsoft.SharePoint.Taxonomy.TaxonomyField]$spweb.Fields[$taxonomy]&#xD;&#xA;&#x9;&#x9;&#x9;if($targetField -ne $null)&#xD;&#xA;&#x9;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9; Write-Host &quot;Connecting with Term set!&quot; $termSet.id &quot; Namely&quot;  $termSet.Name &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;$targetField.sspid = $termstore.id&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;$targetField.termsetid = $termSet.id&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;$targetField.Update($true)&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;}&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;$spweb.Dispose()&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;}&#x9;&#x9;&#xD;&#xA;    }&#x9;&#xD;&#xA;&#x9;$site.Dispose()&#x9;&#xD;&#xA;}&#xD;&#xA;       &#xD;&#xA;&#xD;&#xA;" />
</CodeSnippets>