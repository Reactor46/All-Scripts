<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="# This commands script file creates a new BITS transfer job that downloads all Sharepoint 2013 Prerequisites files for Windows Server 2012&#xD;&#xA;# Author: Muawiyah Shannak (@MuShannak)&#xD;&#xA;# Blog: http://mushannak.blogspot.com/&#xD;&#xA;# Last Update : 9/28/2013&#xD;&#xA;# Source: http://gallery.technet.microsoft.com/Script-to-SharePoint-2013-702e07df&#xD;&#xA;&#xD;&#xA;$DestinationFolder = Read-Host -Prompt &quot;Please enter the destination path for Sharepoint 2013 Prerequisites files&quot;&#xD;&#xA;&#xD;&#xA;# Note: The Prerequisite Files URLs are subject to change at Microsoft's discretion - check http://technet.microsoft.com/en-us/library/cc262485(v=office.15).aspx and update the links.&#xD;&#xA;$FilesUrlList = ( &#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/9/1/3/9138773A-505D-43E2-AC08-9A77E1E0490B/1033/x64/sqlncli.msi&quot;, # SQL Server 2008 R2 SP1 Native Client&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/8/F/9/8F93DBBD-896B-4760-AC81-646F61363A6D/WcfDataServices.exe&quot;, # Microsoft WCF Data Services 5.0&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/9/1/D/91DA8796-BE1D-46AF-8489-663AB7811517/setup_msipc_x64.msi&quot;, # Microsoft Information Protection and Control Client (MSIPC)&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/E/0/0/E0060D8F-2354-4871-9596-DC78538799CC/Synchronization.msi&quot;, # Microsoft Sync Framework Runtime v1.0 SP1 (x64) &#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/0/1/D/01D06854-CA0C-46F1-ADBA-EBF86010DCC6/r2/MicrosoftIdentityExtensions-64.msi&quot;, # Windows Identity Extensions&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/D/7/2/D72FD747-69B6-40B7-875B-C2B40A6B2BDD/Windows6.1-KB974405-x64.msu&quot;, # Windows Identity Foundation (KB974405)&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/A/6/7/A678AB47-496B-4907-B3D4-0A2D280A13C0/WindowsServerAppFabricSetup_x64.exe&quot;, #Windows Server AppFabric&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/7/B/5/7B51D8D1-20FD-4BF0-87C7-4714F5A1C313/AppFabric1.1-RTM-KB2671763-x64-ENU.exe&quot; # CU 1 for AppFabric 1.1 (KB2671763)&#xD;&#xA;             )&#xD;&#xA;&#xD;&#xA;function CreateDestinationFolder()&#xD;&#xA;{&#xD;&#xA;&#x9;Try&#xD;&#xA;&#x9;{&#xD;&#xA;&#x9;&#x9;## Return true if the Destination Folder exists, otherwise return false&#xD;&#xA;&#x9;&#x9;If (!(Test-Path &quot;$DestinationFolder&quot; -pathType container))&#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;##Creates the destination folder if it does not exist&#xD;&#xA;&#x9;&#x9;&#x9;New-Item $DestinationFolder -ItemType Directory&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;}&#xD;&#xA;&#x9;Catch&#xD;&#xA;&#x9;{&#xD;&#xA;&#x9;&#x9;Write-Host &quot;An error occurred creating destination folder (`'$DestinationFolder`'), Please check the path,and try again.&quot;&#xD;&#xA;&#x9;&#x9;Pause&#xD;&#xA;&#x9;&#x9;break&#xD;&#xA;&#x9;}&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;function DownloadSP2013Files()&#xD;&#xA;{&#xD;&#xA;&#x9;Import-Module BitsTransfer&#xD;&#xA;&#x9;Write-Host &quot;BitsTransfer Module is loaded&quot;&#xD;&#xA;&#x9;Write-Host &quot;Downloading...&quot;&#xD;&#xA;&#xD;&#xA;&#x9;ForEach ($FileUrl in $FilesUrlList)&#xD;&#xA;&#x9;{&#xD;&#xA;&#x9;&#x9;## Get the file name&#xD;&#xA;&#x9;&#x9;$DestinationFileName = $FileUrl.Split('/')[-1]&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;Try&#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;## Return true if the file exists, otherwise return false&#xD;&#xA;&#x9;&#x9;&#x9;If (!(Test-Path &quot;$DestinationFolder\$DestinationFileName&quot;))&#xD;&#xA;&#x9;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;Write-Host &quot;`'$FileUrl`' ...&quot;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;Start-BitsTransfer -Source $FileUrl -Destination $DestinationFolder\$DestinationFileName -Priority High -ErrorVariable err&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;If ($err) {Throw &quot;&quot;}&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;Else&#xD;&#xA;&#x9;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;Write-Host &quot;File $DestinationFileName already exists, skipping...&quot;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;Catch&#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;Write-Warning &quot;An error occurred downloading `'$DestinationFileName`'&quot;&#xD;&#xA;&#x9;&#x9;&#x9;break&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;}&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;function Pause($Message=&quot;Press any key to continue...&quot;)&#xD;&#xA;{&#xD;&#xA;&#x9;Write-Host -NoNewLine $Message&#xD;&#xA;&#x9;$null = $host.UI.RawUI.ReadKey(&quot;NoEcho,IncludeKeyDown&quot;)&#xD;&#xA;&#x9;Write-Host &quot;&quot;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;CreateDestinationFolder &#xD;&#xA;DownloadSP2013Files&#xD;&#xA;Pause&#xD;&#xA;" />
  <Code Content="# This commands script file creates a new BITS transfer job that downloads all Sharepoint 2013 Prerequisites files for Windows Server 2012&#xD;&#xA;# Author: Muawiyah Shannak (@MuShannak)&#xD;&#xA;# Blog: http://mushannak.blogspot.com/&#xD;&#xA;# Last Update : 9/28/2013&#xD;&#xA;# Source: http://gallery.technet.microsoft.com/Script-to-SharePoint-2013-702e07df&#xD;&#xA;&#xD;&#xA;$DestinationFolder = Read-Host -Prompt &quot;Please enter the destination path for Sharepoint 2013 Prerequisites files&quot;&#xD;&#xA;&#xD;&#xA;# Note: The Prerequisite Files URLs are subject to change at Microsoft's discretion - check http://technet.microsoft.com/en-us/library/cc262485(v=office.15).aspx and update the links.&#xD;&#xA;$FilesUrlList = ( &#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/9/1/3/9138773A-505D-43E2-AC08-9A77E1E0490B/1033/x64/sqlncli.msi&quot;, # SQL Server 2008 R2 SP1 Native Client&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/8/F/9/8F93DBBD-896B-4760-AC81-646F61363A6D/WcfDataServices.exe&quot;, # Microsoft WCF Data Services 5.0&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/9/1/D/91DA8796-BE1D-46AF-8489-663AB7811517/setup_msipc_x64.msi&quot;, # Microsoft Information Protection and Control Client (MSIPC)&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/E/0/0/E0060D8F-2354-4871-9596-DC78538799CC/Synchronization.msi&quot;, # Microsoft Sync Framework Runtime v1.0 SP1 (x64) &#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/0/1/D/01D06854-CA0C-46F1-ADBA-EBF86010DCC6/r2/MicrosoftIdentityExtensions-64.msi&quot;, # Windows Identity Extensions&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/D/7/2/D72FD747-69B6-40B7-875B-C2B40A6B2BDD/Windows6.1-KB974405-x64.msu&quot;, # Windows Identity Foundation (KB974405)&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/A/6/7/A678AB47-496B-4907-B3D4-0A2D280A13C0/WindowsServerAppFabricSetup_x64.exe&quot;, #Windows Server AppFabric&#xD;&#xA;&#x9;&#x9;&quot;http://download.microsoft.com/download/7/B/5/7B51D8D1-20FD-4BF0-87C7-4714F5A1C313/AppFabric1.1-RTM-KB2671763-x64-ENU.exe&quot; # CU 1 for AppFabric 1.1 (KB2671763)&#xD;&#xA;             )&#xD;&#xA;&#xD;&#xA;function CreateDestinationFolder()&#xD;&#xA;{&#xD;&#xA;&#x9;Try&#xD;&#xA;&#x9;{&#xD;&#xA;&#x9;&#x9;## Return true if the Destination Folder exists, otherwise return false&#xD;&#xA;&#x9;&#x9;If (!(Test-Path &quot;$DestinationFolder&quot; -pathType container))&#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;##Creates the destination folder if it does not exist&#xD;&#xA;&#x9;&#x9;&#x9;New-Item $DestinationFolder -ItemType Directory&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;}&#xD;&#xA;&#x9;Catch&#xD;&#xA;&#x9;{&#xD;&#xA;&#x9;&#x9;Write-Host &quot;An error occurred creating destination folder (`'$DestinationFolder`'), Please check the path,and try again.&quot;&#xD;&#xA;&#x9;&#x9;Pause&#xD;&#xA;&#x9;&#x9;break&#xD;&#xA;&#x9;}&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;function DownloadSP2013Files()&#xD;&#xA;{&#xD;&#xA;&#x9;Import-Module BitsTransfer&#xD;&#xA;&#x9;Write-Host &quot;BitsTransfer Module is loaded&quot;&#xD;&#xA;&#x9;Write-Host &quot;Downloading...&quot;&#xD;&#xA;&#xD;&#xA;&#x9;ForEach ($FileUrl in $FilesUrlList)&#xD;&#xA;&#x9;{&#xD;&#xA;&#x9;&#x9;## Get the file name&#xD;&#xA;&#x9;&#x9;$DestinationFileName = $FileUrl.Split('/')[-1]&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;Try&#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;&#x9;## Return true if the file exists, otherwise return false&#xD;&#xA;&#x9;&#x9;&#x9;If (!(Test-Path &quot;$DestinationFolder\$DestinationFileName&quot;))&#xD;&#xA;&#x9;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;Write-Host &quot;`'$FileUrl`' ...&quot;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;Start-BitsTransfer -Source $FileUrl -Destination $DestinationFolder\$DestinationFileName -Priority High -ErrorVariable err&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;If ($err) {Throw &quot;&quot;}&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;&#x9;Else&#xD;&#xA;&#x9;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;Write-Host &quot;File $DestinationFileName already exists, skipping...&quot;&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;Catch&#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;Write-Warning &quot;An error occurred downloading `'$DestinationFileName`'&quot;&#xD;&#xA;&#x9;&#x9;&#x9;break&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;}&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;function Pause($Message=&quot;Press any key to continue...&quot;)&#xD;&#xA;{&#xD;&#xA;&#x9;Write-Host -NoNewLine $Message&#xD;&#xA;&#x9;$null = $host.UI.RawUI.ReadKey(&quot;NoEcho,IncludeKeyDown&quot;)&#xD;&#xA;&#x9;Write-Host &quot;&quot;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;CreateDestinationFolder &#xD;&#xA;DownloadSP2013Files&#xD;&#xA;Pause&#xD;&#xA;" />
</CodeSnippets>