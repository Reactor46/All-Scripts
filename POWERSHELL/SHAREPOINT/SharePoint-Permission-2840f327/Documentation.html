<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>SharePoint 2013 Permission Report: Find Access Rights for Specific User in Farm</title>        
        <meta name="description" content="Requirement: To ensure security, generate permissions report on all locations like (sites, lists, etc.) where a specific user has permissions.


When people moving from one role to another, Its necessary to audit their permissions on sites and lists where user has access right" />
        <link href="https://i1.code.msdn.s-msft.com/RequestReduceContent/c82dc8ab865be0fb7316b2e09ac97654-bafb67d64bd55a2b1fd123070a82b424-RequestReducedStyle.css" rel="Stylesheet" type="text/css" />        
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.6.1.min.js" type="text/javascript" ></script>
        <script src="https://i1.code.msdn.s-msft.com/RequestReduceContent/a12c72272a8fe142a00d8aae0ff5525e-cf9957f54e208c66abb738158989dd84-RequestReducedScript.js" type="text/javascript" ></script>                        <script type="text/javascript">
            function initializePage() {
                var activeTabData = 'activeTab';
                var otherTabClass = 'otherTab';
                var hiddenPreClass = 'hidden';
                $("a[href^=#]").attr("target","_self");
                $("div.scriptcode").each(function (i) {
                    var scriptBlock = $(this);
                    scriptBlock.trackCopy(trackCodeSnippetCodeDownload);
                    var labelElems = scriptBlock.find("div.title > span");
                    if (labelElems.length == 0) {
                        labelElems = scriptBlock.find("div.title");
                    }
                    var languageSpans = scriptBlock.find("span.hidden");
                    var pres = scriptBlock.find("pre");
                    if (languageSpans.length > 0 && pres.length > 1) {
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            var languageSpan = $(languageSpans[index]);
                            labelSpan.data('code', codePre.text().replace(/(\r(\n)?)|((\r)?\n)/ig, '\r\n'));
                            codePre.removeClass(hiddenPreClass);  
                            codePre.addClass(languageSpan.text().replace(/^\s+|\s+$/g,""));
                            codePre.chili();
                            languageSpan.remove();
                        });

                        pres = scriptBlock.find("pre");
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            if (index == 0) {
                                scriptBlock.data(activeTabData, 0);
                            }
                            else {
                                labelSpan.addClass(otherTabClass);
                                codePre.addClass(hiddenPreClass);  
                            }
                            labelSpan.click(function (e) {
                                var activeTab = scriptBlock.data(activeTabData);
                                $(labelElems[activeTab]).addClass(otherTabClass);   
                                $(pres[activeTab]).addClass(hiddenPreClass);   
                                        
                                codePre.removeClass(hiddenPreClass);    
                                labelSpan.removeClass(otherTabClass);
                                scriptBlock.data(activeTabData, index);

                                if( window.parent.Galleries ) {
                                    window.parent.Galleries.project.resizeDesc();
                                }
                            });
                        });

                        var preview = scriptBlock.find('div.preview');
                        if (preview.length == 0) {
                            preview = $(pres[pres.length - 1]);
                        }
                        preview.remove();

                        if (window.clipboardData && clipboardData.setData) {
                            var copyLink = $("<a href='#' class='copyCode'>Copy code</a>");
                            copyLink.click(function (e) {
                                trackCodeSnippetCodeDownload();
                                clipboardData.setData("Text", $(labelElems[scriptBlock.data(activeTabData)]).data('code'));
                                return false;
                            });
                            $(this).prepend(copyLink);
                        }
                    }
                });

                if ((window.parent) && (window.parent.Galleries)) {
                    window.parent.Galleries.project.resizeDesc();
                }

                    if (top.location == self.location) {
                         window.location.replace(window.location.href.replace('/description', ''));
                    }
            }

            function trackCodeSnippetCodeDownload() {
                if ((window.parent) && (window.parent.gTracker)) {
                    window.parent.gTracker.createActionEvent('Description', 'Download', 'Copy', 'CodeSnippet', null);
                }
            }
            
            function overrideAnchorLinksForFirefoxAndChrome(iframeId) {
                if(($.browser.mozilla && parseInt($.browser.version, 10) >= 2) || $.browser.webkit) {
                    var iframeOffset = $("#" + iframeId, window.parent.document).offset();
                    $("a").each(function () {
                        var link = $(this);
                        var href = link.attr("href");
                        if (href && href[0] == "#") {
                            var name = href.substring(1);
                            $(this).click(function () {
                                var nameElement = $("[name='" + name + "']");
                                var idElement = $("#" + name);
                                var element = null;
                                if (nameElement.length > 0) {
                                    element = nameElement;
                                } else if (idElement.length > 0) {
                                    element = idElement;
                                }

                                if (element) {
                                    var offset = element.offset();
                                    window.parent.scrollTo(offset.left, offset.top + iframeOffset.top);
                                }

                                return false;
                            });
                        }
                    });
                }
            }

            $(window).load(function(){
                initializePage();
                overrideAnchorLinksForFirefoxAndChrome("longdescIframe");

            });

        </script>
        <base target="_parent" />
    </head>
    <body>
        <div id="longDesc">
            
<p><strong>Requirement:</strong> To ensure security, generate permissions report on all locations like (sites, lists, etc.) where a specific user has permissions.
<br>
<br>
When people moving from one role to another, Its necessary to audit their permissions on sites and lists where user has access rights. But unfortunately, There is no out of the box ways to find all sites and lists where a particular user has been granted access
 in SharePoint with out using third party tools. Luckily, We've PowerShell! Lets find all SharePoint sites and lists where a particular user has access rights.<br>
<br>
<strong>PowerShell Script to Check and Generate Report on Access Rights for a Specific User</strong>:<br>
With this script, you can analyze and track the security effectively check what permissions on an account has been granted on each all places in SharePoint. This PowerShell script scans these areas to to retrieve a specific user's access rights:</p>
<ul>
<li>Farm Administrator's Group </li><li>Central Administration Web Application Policies </li><li>Site Collection Administrators&nbsp; </li><li>Scans the all Site collections and Sub-sites with Unique Permissions </li><li>Scans all Lists and Libraries with unique permissions </li><li>Scans All Folders and Items with Unique permissions. </li></ul>
<p>After executing the script, it generates a CSV file (Tab Separated, In fact!) with details: URL, Site/List, Title, Permission Type, Permissions as in the below screenshot.</p>
<div style="overflow:hidden; color:#000000; background-color:#ffffff; text-align:left; text-decoration:none; border:medium none">
<img id="74307" src="/scriptcenter/site/view/file/74307/1/SharePoint%20User%20Permission%20Report.png" alt="" width="849" height="207"><br>
<a href="http://www.sharepointdiary.com/2013/01/permission-report-for-specific-user.html#ixzz2HOVGbDQl" style="color:#003399"></a></div>
<div style="overflow:hidden; color:#000000; background-color:#ffffff; text-align:left; text-decoration:none; border:medium none">
</div>
<div style="overflow:hidden; color:#000000; background-color:#ffffff; text-align:left; text-decoration:none; border:medium none">
<strong>Limitation:</strong> Currently, it doesn't count on Active Directory groups! Say, for e.g.&nbsp; An Active Directory security group may include the user you are searching for, and that group may be granted with access rights.</div>
<div style="overflow:hidden; color:#000000; background-color:#ffffff; text-align:left; text-decoration:none; border:medium none">
<div style="overflow:hidden; color:#000000; background-color:#ffffff; text-align:left; text-decoration:none; border:medium none">
<br>
Read more:<a title="http://www.sharepointdiary.com/2015/01/sharepoint-permission-analysis-reporting-powershell.html" href="http://www.sharepointdiary.com/2015/01/sharepoint-permission-analysis-reporting-powershell.html" target="_blank">http://www.sharepointdiary.com/2015/01/sharepoint-permission-analysis-reporting-powershell.html<span style="color:#003399">&nbsp;</span></a></div>
<div style="overflow:hidden; color:#000000; background-color:#ffffff; text-align:left; text-decoration:none; border:medium none">
</div>
<div style="overflow:hidden; color:#000000; background-color:#ffffff; text-align:left; text-decoration:none; border:medium none">
Code Snippet: Here Part of the script - Download for the complete script.</div>
<div style="overflow:hidden; color:#000000; background-color:#ffffff; text-align:left; text-decoration:none; border:medium none">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershell</span>
<pre class="hidden">Add-PSSnapin Microsoft.SharePoint.PowerShell -ErrorAction SilentlyContinue

#Function to retrieve Permission data
Function Get-PermissionInfo([String]$UserID, [Microsoft.SharePoint.SPSecurableObject]$Object)
{
	#Object Array to hold Permission data
    $PermissionDataCollection = @()

	#Determine the given Object type and Get URL of it
    switch($Object.GetType().FullName)
	{
		&quot;Microsoft.SharePoint.SPWeb&quot;  { $ObjectType = &quot;Site&quot; ; $ObjectURL = $Object.URL }
		&quot;Microsoft.SharePoint.SPListItem&quot; 
		{ 
			if($Object.Folder -ne $null)
			{
			 	$ObjectType = &quot;Folder&quot; ; $ObjectURL = &quot;$($Object.Web.Url)/$($Object.Url)&quot; 
			}
			else
			{
				$ObjectType = &quot;List Item&quot;; $ObjectURL = &quot;$($Object.Web.Url)/$($Object.Url)&quot; 
			}
		}
		#Microsoft.SharePoint.SPList, Microsoft.SharePoint.SPDocumentLibrary, &quot;Microsoft.SharePoint.SPPictureLibrary&quot;,etc
		default { $ObjectType = &quot;List/Library&quot;; $ObjectURL = &quot;$($Object.ParentWeb.Url)/$($Object.RootFolder.URL)&quot; }
	}
	
	#Get Permissions of the user on given object - Such as: Web, List, Folder, ListItem
	$UserPermissionInfo = $Object.GetUserEffectivePermissionInfo($UserID)
	#Iterate through each permission and get the details
	foreach($UserRoleAssignment in $UserPermissionInfo.RoleAssignments)
	{
		#Get all permission levels assigned to User account directly or via SharePOint Group
		$UserPermissions=@()
        foreach ($UserRoleDefinition in $UserRoleAssignment.RoleDefinitionBindings)
        {
			#Exclude &quot;Limited Accesses&quot;
			if($UserRoleDefinition.Name -ne &quot;Limited Access&quot;)
			{
        		$UserPermissions &#43;= $UserRoleDefinition.Name
			}
        }
	
		#Determine Permissions granted directly or through SharePoint Group
		if($UserPermissions)
		{
			if($UserRoleAssignment.Member -is [Microsoft.SharePoint.SPGroup])   
			{
				 $PermissionType = &quot;Member of SharePoint Group: &quot; &#43; $UserRoleAssignment.Member.Name				 
			}
			else
			{
				$PermissionType = &quot;Direct Permission&quot;
			}
			$UserPermissions = $UserPermissions -join &quot;;&quot; 	
	
			#Create an object to hold storage data
	        $PermissionData = New-Object PSObject
	        $PermissionData | Add-Member -type NoteProperty -name &quot;Object&quot; -value $ObjectType
			$PermissionData | Add-Member -type NoteProperty -name &quot;Title&quot; -value $Object.Title
	        $PermissionData | Add-Member -type NoteProperty -name &quot;URL&quot; -value $ObjectURL		
			$PermissionData | Add-Member -type NoteProperty -name &quot;Permission Type&quot; -value $PermissionType
			$PermissionData | Add-Member -type NoteProperty -name &quot;Permissions&quot; -value $UserPermissions
			$PermissionDataCollection &#43;= $PermissionData
		}			
	}	
	Return $PermissionDataCollection
}

#Function to Generate Permission Report
Function Generate-PermissionReport($UserID, $WebAppURL, $ReportPath)
{
    #Output Report location, delete the file, If already exist!
    if (Test-Path $ReportPath)
     {
        Remove-Item $ReportPath
     }
	 
	  #Write Output Report CSV File Headers
	 &quot;Object, Title, URL, Permission Type, Permissions&quot; | out-file $ReportPath

	###Check Whether the Search Users is a Farm Administrator ###
	Write-host &quot;Scanning Farm Administrators...&quot; 
  	#Get the SharePoint Central Administration site
  	$AdminWebApp = Get-SPwebapplication -includecentraladministration | where {$_.IsAdministrationWebApplication}
    $AdminSite = Get-SPWeb $AdminWebApp.Url
    $AdminGroupName = $AdminSite.AssociatedOwnerGroup
    $FarmAdminGroup = $AdminSite.SiteGroups[$AdminGroupName]
 
	#enumerate in farm adminidtrators groups
    foreach ($user in $FarmAdminGroup.users)
    {
    	if($user.LoginName.Endswith($UserID,1)) #1 to Ignore Case
    	{
    			&quot;Farm, $($AdminSite.Title), $($AdminWebApp.URL), Farm Administrators Group, Farm Administrator&quot; | Out-File $ReportPath -Append
    	}     
    }
 
	### Check Web Application User Policies ###
	Write-host &quot;Scanning Web Application Policies...&quot; 
 	$WebApp = Get-SPWebApplication $WebAppURL
 
		foreach ($Policy in $WebApp.Policies)
		{
	    	#Check if the search users is member of the group
	  		if($Policy.UserName.EndsWith($UserID,1))
	     	{
	    		#Write-Host $Policy.UserName
	     		$PolicyRoles=@()
			    foreach($Role in $Policy.PolicyRoleBindings)
			    {
			    	$PolicyRoles&#43;= $Role.Name &#43;&quot;;&quot;
			    }
			#Send Data to CSV File
	    	&quot;Web Application, $($WebApp.Name), $($WebApp.URL), Web Application Policy, $($PolicyRoles)&quot; | Out-File $ReportPath -Append
			}
		}

	#Convert UserID Into Claims format - If WebApp is claims based! Domain\User to i:0#.w|Domain\User
    if($WebApp.UseClaimsAuthentication)
    {
        $ClaimsUserID = (New-SPClaimsPrincipal -identity $UserID -identitytype 1).ToEncodedString()
    }
	
	#Get all Site collections of given web app
	$SiteCollections = Get-SPSite -WebApplication $WebAppURL -Limit All

	#Loop through all site collections 
    foreach($Site in $SiteCollections)
    {
    	Write-host &quot;Scanning Site Collection:&quot; $site.Url
		###Check Whether the User is a Site Collection Administrator
   		foreach($SiteCollAdmin in $Site.RootWeb.SiteAdministrators)
        {
    		if($SiteCollAdmin.LoginName.EndsWith($ClaimsUserID,1))
   			{
    			&quot;Site Collection, $($Site.RootWeb.Title), $($Site.RootWeb.Url), Site Collection Administrators Group, Site Collection Administrator&quot; | Out-File $ReportPath -Append
   			}     
  		}
		
		#Get all webs
		$WebsCollection = $Site.AllWebs
		#Loop throuh each Site (web)
		foreach($Web in $WebsCollection)
		{
	   			if($Web.HasUniqueRoleAssignments -eq $True)
	            {
					Write-host &quot;Scanning Site:&quot; $Web.Url
				
					#Get Permissions of the user on Web
					$WebPermissions = Get-PermissionInfo $ClaimsUserID $Web
					
					#Export Web permission data to CSV file - Append
					$WebPermissions |  Export-csv $ReportPath  -notypeinformation -Append 
				}	
				
				#Check Lists with Unique Permissions
				Write-host &quot;Scanning Lists on $($web.url)...&quot;
				foreach($List in $web.Lists)
				{
            		if($List.HasUniqueRoleAssignments -eq $True -and ($List.Hidden -eq $false))
                	{
						#Get Permissions of the user on list
                        $ListPermissions = Get-PermissionInfo $ClaimsUserID $List
						
						#Export Web permission data to CSV file - Append
						$ListPermissions |  Export-csv $ReportPath -notypeinformation -Append 						
					}
				
					#Check Folders with Unique Permissions
					$UniqueFolders = $List.Folders | where { $_.HasUniqueRoleAssignments -eq $True }                    
                    #Get Folder permissions
                    foreach($folder in $UniqueFolders)
				    {
                        $FolderPermissions = Get-PermissionInfo $ClaimsUserID $folder
				
						#Export Folder permission data to CSV file - Append
						$FolderPermissions |  Export-csv $ReportPath -notypeinformation -Append				
                    }
				
					#Check List Items with Unique Permissions
					$UniqueItems = $List.Items | where { $_.HasUniqueRoleAssignments -eq $True }
                    #Get Item level permissions
                    foreach($item in $UniqueItems)
				    {
                        $ItemPermissions = Get-PermissionInfo $ClaimsUserID $Item
						
						#Export List Items permission data to CSV file - Append
						$ItemPermissions |  Export-csv $ReportPath -notypeinformation -Append 			
                    }
				}
		}
	}
	Write-Host Permission Report Generated successfully!
}

#Input Variables
$WebAppURL = &quot;http://intranet.crescent.com&quot;
$Userid =&quot;Crescent\Salaudeen&quot; 
$ReportPath = &quot;D:\Reports\PermissionRpt.csv&quot;

#Call the function to generate user access report
Generate-PermissionReport $Userid $WebAppURL $ReportPath</pre>
<div class="preview">
<pre class="powershell"><span class="powerShell__cmdlets">Add-PSSnapin</span>&nbsp;Microsoft.SharePoint.PowerShell&nbsp;<span class="powerShell__operator">-</span>ErrorAction&nbsp;SilentlyContinue&nbsp;
&nbsp;
<span class="powerShell__com">#Function&nbsp;to&nbsp;retrieve&nbsp;Permission&nbsp;data</span>&nbsp;
<span class="powerShell__keyword">Function</span>&nbsp;Get<span class="powerShell__operator">-</span>PermissionInfo([String]<span class="powerShell__variable">$UserID</span>,&nbsp;[Microsoft.SharePoint.SPSecurableObject]<span class="powerShell__variable">$Object</span>)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Object&nbsp;Array&nbsp;to&nbsp;hold&nbsp;Permission&nbsp;data</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionDataCollection</span>&nbsp;=&nbsp;@()&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Determine&nbsp;the&nbsp;given&nbsp;Object&nbsp;type&nbsp;and&nbsp;Get&nbsp;URL&nbsp;of&nbsp;it</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">switch</span>(<span class="powerShell__variable">$Object</span>.GetType().FullName)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__string">&quot;Microsoft.SharePoint.SPWeb&quot;</span>&nbsp;&nbsp;{&nbsp;<span class="powerShell__variable">$ObjectType</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;Site&quot;</span>&nbsp;;&nbsp;<span class="powerShell__variable">$ObjectURL</span>&nbsp;=&nbsp;<span class="powerShell__variable">$Object</span>.URL&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__string">&quot;Microsoft.SharePoint.SPListItem&quot;</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$Object</span>.Folder&nbsp;<span class="powerShell__operator">-</span>ne&nbsp;<span class="powerShell__variable">$null</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$ObjectType</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;Folder&quot;</span>&nbsp;;&nbsp;<span class="powerShell__variable">$ObjectURL</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;$($Object.Web.Url)/$($Object.Url)&quot;</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">else</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$ObjectType</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;List&nbsp;Item&quot;</span>;&nbsp;<span class="powerShell__variable">$ObjectURL</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;$($Object.Web.Url)/$($Object.Url)&quot;</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Microsoft.SharePoint.SPList,&nbsp;Microsoft.SharePoint.SPDocumentLibrary,&nbsp;&quot;Microsoft.SharePoint.SPPictureLibrary&quot;,etc</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default&nbsp;{&nbsp;<span class="powerShell__variable">$ObjectType</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;List/Library&quot;</span>;&nbsp;<span class="powerShell__variable">$ObjectURL</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;$($Object.ParentWeb.Url)/$($Object.RootFolder.URL)&quot;</span>&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Get&nbsp;Permissions&nbsp;of&nbsp;the&nbsp;user&nbsp;on&nbsp;given&nbsp;object&nbsp;-&nbsp;Such&nbsp;as:&nbsp;Web,&nbsp;List,&nbsp;Folder,&nbsp;ListItem</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$UserPermissionInfo</span>&nbsp;=&nbsp;<span class="powerShell__variable">$Object</span>.GetUserEffectivePermissionInfo(<span class="powerShell__variable">$UserID</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Iterate&nbsp;through&nbsp;each&nbsp;permission&nbsp;and&nbsp;get&nbsp;the&nbsp;details</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>(<span class="powerShell__variable">$UserRoleAssignment</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$UserPermissionInfo</span>.RoleAssignments)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Get&nbsp;all&nbsp;permission&nbsp;levels&nbsp;assigned&nbsp;to&nbsp;User&nbsp;account&nbsp;directly&nbsp;or&nbsp;via&nbsp;SharePOint&nbsp;Group</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$UserPermissions</span>=@()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>&nbsp;(<span class="powerShell__variable">$UserRoleDefinition</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$UserRoleAssignment</span>.RoleDefinitionBindings)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Exclude&nbsp;&quot;Limited&nbsp;Accesses&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$UserRoleDefinition</span>.Name&nbsp;<span class="powerShell__operator">-</span>ne&nbsp;<span class="powerShell__string">&quot;Limited&nbsp;Access&quot;</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$UserPermissions</span>&nbsp;<span class="powerShell__operator">&#43;</span>=&nbsp;<span class="powerShell__variable">$UserRoleDefinition</span>.Name&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Determine&nbsp;Permissions&nbsp;granted&nbsp;directly&nbsp;or&nbsp;through&nbsp;SharePoint&nbsp;Group</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$UserPermissions</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$UserRoleAssignment</span>.Member&nbsp;<span class="powerShell__operator">-</span>is&nbsp;[Microsoft.SharePoint.SPGroup])&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionType</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;Member&nbsp;of&nbsp;SharePoint&nbsp;Group:&nbsp;&quot;</span>&nbsp;<span class="powerShell__operator">&#43;</span>&nbsp;<span class="powerShell__variable">$UserRoleAssignment</span>.Member.Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">else</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionType</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;Direct&nbsp;Permission&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$UserPermissions</span>&nbsp;=&nbsp;<span class="powerShell__variable">$UserPermissions</span>&nbsp;<span class="powerShell__operator">-</span>join&nbsp;<span class="powerShell__string">&quot;;&quot;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Create&nbsp;an&nbsp;object&nbsp;to&nbsp;hold&nbsp;storage&nbsp;data</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionData</span>&nbsp;=&nbsp;<span class="powerShell__cmdlets">New-Object</span>&nbsp;PSObject&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionData</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;<span class="powerShell__cmdlets">Add-Member</span>&nbsp;<span class="powerShell__operator">-</span><span class="powerShell__alias">type</span>&nbsp;NoteProperty&nbsp;<span class="powerShell__operator">-</span>name&nbsp;<span class="powerShell__string">&quot;Object&quot;</span>&nbsp;<span class="powerShell__operator">-</span>value&nbsp;<span class="powerShell__variable">$ObjectType</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionData</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;<span class="powerShell__cmdlets">Add-Member</span>&nbsp;<span class="powerShell__operator">-</span><span class="powerShell__alias">type</span>&nbsp;NoteProperty&nbsp;<span class="powerShell__operator">-</span>name&nbsp;<span class="powerShell__string">&quot;Title&quot;</span>&nbsp;<span class="powerShell__operator">-</span>value&nbsp;<span class="powerShell__variable">$Object</span>.Title&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionData</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;<span class="powerShell__cmdlets">Add-Member</span>&nbsp;<span class="powerShell__operator">-</span><span class="powerShell__alias">type</span>&nbsp;NoteProperty&nbsp;<span class="powerShell__operator">-</span>name&nbsp;<span class="powerShell__string">&quot;URL&quot;</span>&nbsp;<span class="powerShell__operator">-</span>value&nbsp;<span class="powerShell__variable">$ObjectURL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionData</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;<span class="powerShell__cmdlets">Add-Member</span>&nbsp;<span class="powerShell__operator">-</span><span class="powerShell__alias">type</span>&nbsp;NoteProperty&nbsp;<span class="powerShell__operator">-</span>name&nbsp;<span class="powerShell__string">&quot;Permission&nbsp;Type&quot;</span>&nbsp;<span class="powerShell__operator">-</span>value&nbsp;<span class="powerShell__variable">$PermissionType</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionData</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;<span class="powerShell__cmdlets">Add-Member</span>&nbsp;<span class="powerShell__operator">-</span><span class="powerShell__alias">type</span>&nbsp;NoteProperty&nbsp;<span class="powerShell__operator">-</span>name&nbsp;<span class="powerShell__string">&quot;Permissions&quot;</span>&nbsp;<span class="powerShell__operator">-</span>value&nbsp;<span class="powerShell__variable">$UserPermissions</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PermissionDataCollection</span>&nbsp;<span class="powerShell__operator">&#43;</span>=&nbsp;<span class="powerShell__variable">$PermissionData</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">Return</span>&nbsp;<span class="powerShell__variable">$PermissionDataCollection</span>&nbsp;
}&nbsp;
&nbsp;
<span class="powerShell__com">#Function&nbsp;to&nbsp;Generate&nbsp;Permission&nbsp;Report</span>&nbsp;
<span class="powerShell__keyword">Function</span>&nbsp;Generate<span class="powerShell__operator">-</span>PermissionReport(<span class="powerShell__variable">$UserID</span>,&nbsp;<span class="powerShell__variable">$WebAppURL</span>,&nbsp;<span class="powerShell__variable">$ReportPath</span>)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Output&nbsp;Report&nbsp;location,&nbsp;delete&nbsp;the&nbsp;file,&nbsp;If&nbsp;already&nbsp;exist!</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__cmdlets">Test-Path</span>&nbsp;<span class="powerShell__variable">$ReportPath</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__cmdlets">Remove-Item</span>&nbsp;<span class="powerShell__variable">$ReportPath</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Write&nbsp;Output&nbsp;Report&nbsp;CSV&nbsp;File&nbsp;Headers</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__string">&quot;Object,&nbsp;Title,&nbsp;URL,&nbsp;Permission&nbsp;Type,&nbsp;Permissions&quot;</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;out<span class="powerShell__operator">-</span>file&nbsp;<span class="powerShell__variable">$ReportPath</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">###Check&nbsp;Whether&nbsp;the&nbsp;Search&nbsp;Users&nbsp;is&nbsp;a&nbsp;Farm&nbsp;Administrator&nbsp;###</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Write<span class="powerShell__operator">-</span>host&nbsp;<span class="powerShell__string">&quot;Scanning&nbsp;Farm&nbsp;Administrators...&quot;</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Get&nbsp;the&nbsp;SharePoint&nbsp;Central&nbsp;Administration&nbsp;site</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$AdminWebApp</span>&nbsp;=&nbsp;Get<span class="powerShell__operator">-</span>SPwebapplication&nbsp;<span class="powerShell__operator">-</span>includecentraladministration&nbsp;<span class="powerShell__operator">|</span>&nbsp;where&nbsp;{<span class="powerShell__variable">$_</span>.IsAdministrationWebApplication}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$AdminSite</span>&nbsp;=&nbsp;Get<span class="powerShell__operator">-</span>SPWeb&nbsp;<span class="powerShell__variable">$AdminWebApp</span>.Url&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$AdminGroupName</span>&nbsp;=&nbsp;<span class="powerShell__variable">$AdminSite</span>.AssociatedOwnerGroup&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$FarmAdminGroup</span>&nbsp;=&nbsp;<span class="powerShell__variable">$AdminSite</span>.SiteGroups[<span class="powerShell__variable">$AdminGroupName</span>]&nbsp;
&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#enumerate&nbsp;in&nbsp;farm&nbsp;adminidtrators&nbsp;groups</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>&nbsp;(<span class="powerShell__variable">$user</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$FarmAdminGroup</span>.users)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$user</span>.LoginName.Endswith(<span class="powerShell__variable">$UserID</span>,1))&nbsp;<span class="powerShell__com">#1&nbsp;to&nbsp;Ignore&nbsp;Case</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__string">&quot;Farm,&nbsp;$($AdminSite.Title),&nbsp;$($AdminWebApp.URL),&nbsp;Farm&nbsp;Administrators&nbsp;Group,&nbsp;Farm&nbsp;Administrator&quot;</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;Out<span class="powerShell__operator">-</span>File&nbsp;<span class="powerShell__variable">$ReportPath</span>&nbsp;<span class="powerShell__operator">-</span>Append&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">###&nbsp;Check&nbsp;Web&nbsp;Application&nbsp;User&nbsp;Policies&nbsp;###</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Write<span class="powerShell__operator">-</span>host&nbsp;<span class="powerShell__string">&quot;Scanning&nbsp;Web&nbsp;Application&nbsp;Policies...&quot;</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$WebApp</span>&nbsp;=&nbsp;Get<span class="powerShell__operator">-</span>SPWebApplication&nbsp;<span class="powerShell__variable">$WebAppURL</span>&nbsp;
&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>&nbsp;(<span class="powerShell__variable">$Policy</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$WebApp</span>.Policies)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Check&nbsp;if&nbsp;the&nbsp;search&nbsp;users&nbsp;is&nbsp;member&nbsp;of&nbsp;the&nbsp;group</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$Policy</span>.UserName.EndsWith(<span class="powerShell__variable">$UserID</span>,1))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Write-Host&nbsp;$Policy.UserName</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PolicyRoles</span>=@()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>(<span class="powerShell__variable">$Role</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$Policy</span>.PolicyRoleBindings)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$PolicyRoles</span><span class="powerShell__operator">&#43;</span>=&nbsp;<span class="powerShell__variable">$Role</span>.Name&nbsp;<span class="powerShell__operator">&#43;</span><span class="powerShell__string">&quot;;&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Send&nbsp;Data&nbsp;to&nbsp;CSV&nbsp;File</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__string">&quot;Web&nbsp;Application,&nbsp;$($WebApp.Name),&nbsp;$($WebApp.URL),&nbsp;Web&nbsp;Application&nbsp;Policy,&nbsp;$($PolicyRoles)&quot;</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;Out<span class="powerShell__operator">-</span>File&nbsp;<span class="powerShell__variable">$ReportPath</span>&nbsp;<span class="powerShell__operator">-</span>Append&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Convert&nbsp;UserID&nbsp;Into&nbsp;Claims&nbsp;format&nbsp;-&nbsp;If&nbsp;WebApp&nbsp;is&nbsp;claims&nbsp;based!&nbsp;Domain\User&nbsp;to&nbsp;i:0#.w|Domain\User</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$WebApp</span>.UseClaimsAuthentication)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$ClaimsUserID</span>&nbsp;=&nbsp;(New<span class="powerShell__operator">-</span>SPClaimsPrincipal&nbsp;<span class="powerShell__operator">-</span>identity&nbsp;<span class="powerShell__variable">$UserID</span>&nbsp;<span class="powerShell__operator">-</span>identitytype&nbsp;1).ToEncodedString()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Get&nbsp;all&nbsp;Site&nbsp;collections&nbsp;of&nbsp;given&nbsp;web&nbsp;app</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$SiteCollections</span>&nbsp;=&nbsp;Get<span class="powerShell__operator">-</span>SPSite&nbsp;<span class="powerShell__operator">-</span>WebApplication&nbsp;<span class="powerShell__variable">$WebAppURL</span>&nbsp;<span class="powerShell__operator">-</span>Limit&nbsp;All&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Loop&nbsp;through&nbsp;all&nbsp;site&nbsp;collections&nbsp;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>(<span class="powerShell__variable">$Site</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$SiteCollections</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write<span class="powerShell__operator">-</span>host&nbsp;<span class="powerShell__string">&quot;Scanning&nbsp;Site&nbsp;Collection:&quot;</span>&nbsp;<span class="powerShell__variable">$site</span>.Url&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">###Check&nbsp;Whether&nbsp;the&nbsp;User&nbsp;is&nbsp;a&nbsp;Site&nbsp;Collection&nbsp;Administrator</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>(<span class="powerShell__variable">$SiteCollAdmin</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$Site</span>.RootWeb.SiteAdministrators)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$SiteCollAdmin</span>.LoginName.EndsWith(<span class="powerShell__variable">$ClaimsUserID</span>,1))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__string">&quot;Site&nbsp;Collection,&nbsp;$($Site.RootWeb.Title),&nbsp;$($Site.RootWeb.Url),&nbsp;Site&nbsp;Collection&nbsp;Administrators&nbsp;Group,&nbsp;Site&nbsp;Collection&nbsp;Administrator&quot;</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;Out<span class="powerShell__operator">-</span>File&nbsp;<span class="powerShell__variable">$ReportPath</span>&nbsp;<span class="powerShell__operator">-</span>Append&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Get&nbsp;all&nbsp;webs</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$WebsCollection</span>&nbsp;=&nbsp;<span class="powerShell__variable">$Site</span>.AllWebs&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Loop&nbsp;throuh&nbsp;each&nbsp;Site&nbsp;(web)</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>(<span class="powerShell__variable">$Web</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$WebsCollection</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$Web</span>.HasUniqueRoleAssignments&nbsp;<span class="powerShell__operator">-</span>eq&nbsp;<span class="powerShell__variable">$True</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write<span class="powerShell__operator">-</span>host&nbsp;<span class="powerShell__string">&quot;Scanning&nbsp;Site:&quot;</span>&nbsp;<span class="powerShell__variable">$Web</span>.Url&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Get&nbsp;Permissions&nbsp;of&nbsp;the&nbsp;user&nbsp;on&nbsp;Web</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$WebPermissions</span>&nbsp;=&nbsp;Get<span class="powerShell__operator">-</span>PermissionInfo&nbsp;<span class="powerShell__variable">$ClaimsUserID</span>&nbsp;<span class="powerShell__variable">$Web</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Export&nbsp;Web&nbsp;permission&nbsp;data&nbsp;to&nbsp;CSV&nbsp;file&nbsp;-&nbsp;Append</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$WebPermissions</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;&nbsp;<span class="powerShell__cmdlets">Export-csv</span>&nbsp;<span class="powerShell__variable">$ReportPath</span>&nbsp;&nbsp;<span class="powerShell__operator">-</span>notypeinformation&nbsp;<span class="powerShell__operator">-</span>Append&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Check&nbsp;Lists&nbsp;with&nbsp;Unique&nbsp;Permissions</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write<span class="powerShell__operator">-</span>host&nbsp;<span class="powerShell__string">&quot;Scanning&nbsp;Lists&nbsp;on&nbsp;$($web.url)...&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>(<span class="powerShell__variable">$List</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$web</span>.Lists)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>(<span class="powerShell__variable">$List</span>.HasUniqueRoleAssignments&nbsp;<span class="powerShell__operator">-</span>eq&nbsp;<span class="powerShell__variable">$True</span>&nbsp;<span class="powerShell__operator">-</span>and&nbsp;(<span class="powerShell__variable">$List</span>.Hidden&nbsp;<span class="powerShell__operator">-</span>eq&nbsp;<span class="powerShell__variable">$false</span>))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Get&nbsp;Permissions&nbsp;of&nbsp;the&nbsp;user&nbsp;on&nbsp;list</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$ListPermissions</span>&nbsp;=&nbsp;Get<span class="powerShell__operator">-</span>PermissionInfo&nbsp;<span class="powerShell__variable">$ClaimsUserID</span>&nbsp;<span class="powerShell__variable">$List</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Export&nbsp;Web&nbsp;permission&nbsp;data&nbsp;to&nbsp;CSV&nbsp;file&nbsp;-&nbsp;Append</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$ListPermissions</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;&nbsp;<span class="powerShell__cmdlets">Export-csv</span>&nbsp;<span class="powerShell__variable">$ReportPath</span>&nbsp;<span class="powerShell__operator">-</span>notypeinformation&nbsp;<span class="powerShell__operator">-</span>Append&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Check&nbsp;Folders&nbsp;with&nbsp;Unique&nbsp;Permissions</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$UniqueFolders</span>&nbsp;=&nbsp;<span class="powerShell__variable">$List</span>.Folders&nbsp;<span class="powerShell__operator">|</span>&nbsp;where&nbsp;{&nbsp;<span class="powerShell__variable">$_</span>.HasUniqueRoleAssignments&nbsp;<span class="powerShell__operator">-</span>eq&nbsp;<span class="powerShell__variable">$True</span>&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Get&nbsp;Folder&nbsp;permissions</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>(<span class="powerShell__variable">$folder</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$UniqueFolders</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$FolderPermissions</span>&nbsp;=&nbsp;Get<span class="powerShell__operator">-</span>PermissionInfo&nbsp;<span class="powerShell__variable">$ClaimsUserID</span>&nbsp;<span class="powerShell__variable">$folder</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Export&nbsp;Folder&nbsp;permission&nbsp;data&nbsp;to&nbsp;CSV&nbsp;file&nbsp;-&nbsp;Append</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$FolderPermissions</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;&nbsp;<span class="powerShell__cmdlets">Export-csv</span>&nbsp;<span class="powerShell__variable">$ReportPath</span>&nbsp;<span class="powerShell__operator">-</span>notypeinformation&nbsp;<span class="powerShell__operator">-</span>Append&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Check&nbsp;List&nbsp;Items&nbsp;with&nbsp;Unique&nbsp;Permissions</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$UniqueItems</span>&nbsp;=&nbsp;<span class="powerShell__variable">$List</span>.Items&nbsp;<span class="powerShell__operator">|</span>&nbsp;where&nbsp;{&nbsp;<span class="powerShell__variable">$_</span>.HasUniqueRoleAssignments&nbsp;<span class="powerShell__operator">-</span>eq&nbsp;<span class="powerShell__variable">$True</span>&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Get&nbsp;Item&nbsp;level&nbsp;permissions</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>(<span class="powerShell__variable">$item</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$UniqueItems</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$ItemPermissions</span>&nbsp;=&nbsp;Get<span class="powerShell__operator">-</span>PermissionInfo&nbsp;<span class="powerShell__variable">$ClaimsUserID</span>&nbsp;<span class="powerShell__variable">$Item</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__com">#Export&nbsp;List&nbsp;Items&nbsp;permission&nbsp;data&nbsp;to&nbsp;CSV&nbsp;file&nbsp;-&nbsp;Append</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$ItemPermissions</span>&nbsp;<span class="powerShell__operator">|</span>&nbsp;&nbsp;<span class="powerShell__cmdlets">Export-csv</span>&nbsp;<span class="powerShell__variable">$ReportPath</span>&nbsp;<span class="powerShell__operator">-</span>notypeinformation&nbsp;<span class="powerShell__operator">-</span>Append&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Write<span class="powerShell__operator">-</span>Host&nbsp;Permission&nbsp;Report&nbsp;Generated&nbsp;successfully<span class="powerShell__operator">!</span>&nbsp;
}&nbsp;
&nbsp;
<span class="powerShell__com">#Input&nbsp;Variables</span>&nbsp;
<span class="powerShell__variable">$WebAppURL</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;http://intranet.crescent.com&quot;</span>&nbsp;
<span class="powerShell__variable">$Userid</span>&nbsp;=<span class="powerShell__string">&quot;Crescent\Salaudeen&quot;</span>&nbsp;&nbsp;
<span class="powerShell__variable">$ReportPath</span>&nbsp;=&nbsp;<span class="powerShell__string">&quot;D:\Reports\PermissionRpt.csv&quot;</span>&nbsp;
&nbsp;
<span class="powerShell__com">#Call&nbsp;the&nbsp;function&nbsp;to&nbsp;generate&nbsp;user&nbsp;access&nbsp;report</span>&nbsp;
Generate<span class="powerShell__operator">-</span>PermissionReport&nbsp;<span class="powerShell__variable">$Userid</span>&nbsp;<span class="powerShell__variable">$WebAppURL</span>&nbsp;<span class="powerShell__variable">$ReportPath</span></pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;For SharePoint 2007 version, Please download the script from:
<a href="http://www.sharepointdiary.com/2013/01/audit-user-permissions-in-sharepoint.html">
http://www.sharepointdiary.com/2013/01/audit-user-permissions-in-sharepoint.html</a></div>
</div>
<div style="overflow:hidden; color:#000000; background-color:#ffffff; text-align:left; text-decoration:none; border:medium none">
</div>
</div>

        </div>
    </body>
</html>