<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="#########################################################################&#xD;&#xA;#                  Sample Functions&#xD;&#xA;#              Full Code is in the File&#xD;&#xA;#########################################################################&#xD;&#xA;function Get-SPSyncMA&#xD;&#xA;{&#xD;&#xA;[CmdletBinding()]&#xD;&#xA;Param(&#xD;&#xA; [parameter(Mandatory=$true)][string]$ComputerName&#xD;&#xA;)&#xD;&#xA;Process&#xD;&#xA;{&#xD;&#xA;&#x9;Get-WmiObject -ComputerName $ComputerName -Class MIIS_ManagementAgent -Namespace root/MicrosoftIdentityIntegrationServer | Where {$_.Name -like &quot;MOSS*&quot;}&#xD;&#xA;}&#xD;&#xA;}&#xD;&#xA;function Get-FimMARuns&#xD;&#xA;{&#xD;&#xA; [CmdletBinding()]&#xD;&#xA;Param(&#xD;&#xA;&#x9;[parameter(Mandatory=$true)]&#xD;&#xA;&#x9;[string]$MaName,&#xD;&#xA;&#x9;[parameter(Mandatory=$true)]&#xD;&#xA;&#x9;[string]$Hours,&#xD;&#xA;&#x9;[parameter(Mandatory=$true)]&#xD;&#xA;&#x9;[string]$ComputerName&#xD;&#xA;)&#xD;&#xA;Process&#xD;&#xA;{&#xD;&#xA;&#x9;$timeSpan = New-TimeSpan -Hours $Hours&#xD;&#xA;&#x9;$nowUTC = (Get-Date).ToUniversalTime()&#xD;&#xA;&#x9;$timeToStart = $nowUTC.Add(-$timeSpan)&#xD;&#xA;&#x9;$filter = (&quot;MaName = '{0}'&quot; -F $MaName)&#xD;&#xA;&#x9;$allHistory = Get-WmiObject -ComputerName $ComputerName -Class MIIS_RunHistory -Namespace root/MicrosoftIdentityIntegrationServer -Filter $filter&#xD;&#xA;&#x9;ForEach ($history in $allHistory)&#xD;&#xA;&#x9;{&#xD;&#xA;&#x9;&#x9;#Converting the start of the sync operation in order to be easier for comparing with the report interval&#xD;&#xA;&#x9;&#x9;$startTimeinDateTime = $history.RunStartTime | Get-Date&#xD;&#xA;&#x9;&#x9;if ($startTimeinDateTime -gt $timeToStart)&#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;Write-Output $history&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;}&#xD;&#xA;}&#xD;&#xA;}" />
  <Code Content="#########################################################################&#xD;&#xA;#                  Sample Functions&#xD;&#xA;#              Full Code is in the File&#xD;&#xA;#########################################################################&#xD;&#xA;function Get-SPSyncMA&#xD;&#xA;{&#xD;&#xA;[CmdletBinding()]&#xD;&#xA;Param(&#xD;&#xA; [parameter(Mandatory=$true)][string]$ComputerName&#xD;&#xA;)&#xD;&#xA;Process&#xD;&#xA;{&#xD;&#xA;&#x9;Get-WmiObject -ComputerName $ComputerName -Class MIIS_ManagementAgent -Namespace root/MicrosoftIdentityIntegrationServer | Where {$_.Name -like &quot;MOSS*&quot;}&#xD;&#xA;}&#xD;&#xA;}&#xD;&#xA;function Get-FimMARuns&#xD;&#xA;{&#xD;&#xA; [CmdletBinding()]&#xD;&#xA;Param(&#xD;&#xA;&#x9;[parameter(Mandatory=$true)]&#xD;&#xA;&#x9;[string]$MaName,&#xD;&#xA;&#x9;[parameter(Mandatory=$true)]&#xD;&#xA;&#x9;[string]$Hours,&#xD;&#xA;&#x9;[parameter(Mandatory=$true)]&#xD;&#xA;&#x9;[string]$ComputerName&#xD;&#xA;)&#xD;&#xA;Process&#xD;&#xA;{&#xD;&#xA;&#x9;$timeSpan = New-TimeSpan -Hours $Hours&#xD;&#xA;&#x9;$nowUTC = (Get-Date).ToUniversalTime()&#xD;&#xA;&#x9;$timeToStart = $nowUTC.Add(-$timeSpan)&#xD;&#xA;&#x9;$filter = (&quot;MaName = '{0}'&quot; -F $MaName)&#xD;&#xA;&#x9;$allHistory = Get-WmiObject -ComputerName $ComputerName -Class MIIS_RunHistory -Namespace root/MicrosoftIdentityIntegrationServer -Filter $filter&#xD;&#xA;&#x9;ForEach ($history in $allHistory)&#xD;&#xA;&#x9;{&#xD;&#xA;&#x9;&#x9;#Converting the start of the sync operation in order to be easier for comparing with the report interval&#xD;&#xA;&#x9;&#x9;$startTimeinDateTime = $history.RunStartTime | Get-Date&#xD;&#xA;&#x9;&#x9;if ($startTimeinDateTime -gt $timeToStart)&#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;Write-Output $history&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;}&#xD;&#xA;}&#xD;&#xA;}" />
</CodeSnippets>