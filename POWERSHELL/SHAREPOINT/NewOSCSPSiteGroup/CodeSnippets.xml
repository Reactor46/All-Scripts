<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="#Verify user specified permission level&#xD;&#xA;$permissionLevelNames = @()&#xD;&#xA;$spWeb.RoleDefinitions | Foreach-Object {$permissionLevelNames += $_.Name}&#xD;&#xA;$permissionLevelNamesString = $permissionLevelNames -join &quot;,&quot;&#xD;&#xA;if ($permissionLevelNames -notcontains $PermissionLevel) {&#xD;&#xA;    $warningMsg = $Messages.InvalidPermissionLevel&#xD;&#xA;    $warningMsg = $warningMsg -f $PermissionLevel,$permissionLevelNamesString&#xD;&#xA;    $pscmdlet.WriteWarning($warningMsg)&#xD;&#xA;} else {&#xD;&#xA;    $verboseMsg = $Messages.PermissionLevelPrompt&#xD;&#xA;    $verboseMsg = $verboseMsg -f $spGroup,$PermissionLevel&#xD;&#xA;    $pscmdlet.WriteVerbose($verboseMsg)&#xD;&#xA;    #Get role definition item&#xD;&#xA;    $spRoleDefinition = $spWeb.RoleDefinitions.Item($PermissionLevel)                &#xD;&#xA;    #Create a role assigment object&#xD;&#xA;    $spRoleAssignment = New-Object Microsoft.SharePoint.SPRoleAssignment($spGroup)&#xD;&#xA;    $spRoleAssignment.RoleDefinitionBindings.Add($spRoleDefinition)&#xD;&#xA;    $spWeb.RoleAssignments.Add($spRoleAssignment)&#xD;&#xA;}" />
  <Code Content="#Verify user specified permission level&#xD;&#xA;$permissionLevelNames = @()&#xD;&#xA;$spWeb.RoleDefinitions | Foreach-Object {$permissionLevelNames += $_.Name}&#xD;&#xA;$permissionLevelNamesString = $permissionLevelNames -join &quot;,&quot;&#xD;&#xA;if ($permissionLevelNames -notcontains $PermissionLevel) {&#xD;&#xA;    $warningMsg = $Messages.InvalidPermissionLevel&#xD;&#xA;    $warningMsg = $warningMsg -f $PermissionLevel,$permissionLevelNamesString&#xD;&#xA;    $pscmdlet.WriteWarning($warningMsg)&#xD;&#xA;} else {&#xD;&#xA;    $verboseMsg = $Messages.PermissionLevelPrompt&#xD;&#xA;    $verboseMsg = $verboseMsg -f $spGroup,$PermissionLevel&#xD;&#xA;    $pscmdlet.WriteVerbose($verboseMsg)&#xD;&#xA;    #Get role definition item&#xD;&#xA;    $spRoleDefinition = $spWeb.RoleDefinitions.Item($PermissionLevel)                &#xD;&#xA;    #Create a role assigment object&#xD;&#xA;    $spRoleAssignment = New-Object Microsoft.SharePoint.SPRoleAssignment($spGroup)&#xD;&#xA;    $spRoleAssignment.RoleDefinitionBindings.Add($spRoleDefinition)&#xD;&#xA;    $spWeb.RoleAssignments.Add($spRoleAssignment)&#xD;&#xA;}" />
</CodeSnippets>