<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="Param([string] $queryText = 'SharePoint', [string] $siteCollectionUrl = &quot;http://server/sitecollection/site&quot;)&#xD;&#xA;&#xD;&#xA;# Add-PSSnapin -Name Microsoft.SharePoint.PowerShell&#xD;&#xA;[System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint.Client&quot;)&#xD;&#xA;[System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint.Client.Runtime&quot;)&#xD;&#xA;[System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint.Client.Search&quot;)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;$clientContext = New-Object Microsoft.SharePoint.Client.ClientContext($siteCollectionUrl)&#xD;&#xA;&#xD;&#xA;$keywordQuery = New-Object Microsoft.SharePoint.Client.Search.Query.KeywordQuery($clientContext)&#xD;&#xA;$keywordQuery.QueryText = $queryText&#xD;&#xA;&#xD;&#xA;$searchExecutor = New-Object Microsoft.SharePoint.Client.Search.Query.SearchExecutor($clientContext)&#xD;&#xA;&#xD;&#xA;$results = $searchExecutor.ExecuteQuery($keywordQuery)&#xD;&#xA;&#xD;&#xA;$clientContext.ExecuteQuery()&#xD;&#xA;&#xD;&#xA;$formattedResults = @()&#xD;&#xA;&#xD;&#xA;foreach($result in $results.Value[0].ResultRows)&#xD;&#xA;{&#xD;&#xA;    $formattedResult = New-Object -TypeName PSObject&#xD;&#xA;    foreach($key in $result.Keys)&#xD;&#xA;    {&#xD;&#xA;        $formattedResult | Add-Member -Name $key -MemberType NoteProperty -Value $result[$key]&#xD;&#xA;    }&#xD;&#xA;    $formattedResults += $formattedResult&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;$formattedResults" />
  <Code Content="Param([string] $queryText = 'SharePoint', [string] $siteCollectionUrl = &quot;http://server/sitecollection/site&quot;)&#xD;&#xA;&#xD;&#xA;# Add-PSSnapin -Name Microsoft.SharePoint.PowerShell&#xD;&#xA;[System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint.Client&quot;)&#xD;&#xA;[System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint.Client.Runtime&quot;)&#xD;&#xA;[System.Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.SharePoint.Client.Search&quot;)&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;$clientContext = New-Object Microsoft.SharePoint.Client.ClientContext($siteCollectionUrl)&#xD;&#xA;&#xD;&#xA;$keywordQuery = New-Object Microsoft.SharePoint.Client.Search.Query.KeywordQuery($clientContext)&#xD;&#xA;$keywordQuery.QueryText = $queryText&#xD;&#xA;&#xD;&#xA;$searchExecutor = New-Object Microsoft.SharePoint.Client.Search.Query.SearchExecutor($clientContext)&#xD;&#xA;&#xD;&#xA;$results = $searchExecutor.ExecuteQuery($keywordQuery)&#xD;&#xA;&#xD;&#xA;$clientContext.ExecuteQuery()&#xD;&#xA;&#xD;&#xA;$formattedResults = @()&#xD;&#xA;&#xD;&#xA;foreach($result in $results.Value[0].ResultRows)&#xD;&#xA;{&#xD;&#xA;    $formattedResult = New-Object -TypeName PSObject&#xD;&#xA;    foreach($key in $result.Keys)&#xD;&#xA;    {&#xD;&#xA;        $formattedResult | Add-Member -Name $key -MemberType NoteProperty -Value $result[$key]&#xD;&#xA;    }&#xD;&#xA;    $formattedResults += $formattedResult&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;$formattedResults" />
</CodeSnippets>