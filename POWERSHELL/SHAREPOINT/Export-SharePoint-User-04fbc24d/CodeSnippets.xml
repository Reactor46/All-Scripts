<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="# -----------------------------------------------------------------------------&#xD;&#xA;# Script&#x9;: To Export User Profile Information Value in Excel and HTML&#xD;&#xA;# Author&#x9;: Chendrayan Venkatesan&#xD;&#xA;# Date&#x9;&#x9;: October 1 2014&#xD;&#xA;# Version&#x9;: 1.1&#xD;&#xA;# -----------------------------------------------------------------------------&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;#. Use Internal name of the user profile property.&#xD;&#xA;#. Any custom user fields will have &quot;SPS-&quot;.&#xD;&#xA;#. Remove comment &quot;#&quot; in line 43 and do the same in line 48 if you need HTML output.&#xD;&#xA;#. Provide location after out-file to save the HTML file.&#xD;&#xA;#. In Line 59 use the same location as Out-File.&#xD;&#xA;#. Append if you have any custom fields in mysite user profile property&#xD;&#xA;#. For HTML look and feel please copy and paste the style.css in C:\.&#xD;&#xA;#. Use any style.css as per organization standard and policy.&#xD;&#xA;&#xD;&#xA;Add-PSSnapin Microsoft.SharePoint.PowerShell -ErrorAction SilentlyContinue&#xD;&#xA;&#xD;&#xA;$siteUrl = &quot;Your Mysite Host Name&quot;&#xD;&#xA;$outputFile = &quot;Save the Output File in your desired Location&quot;&#xD;&#xA;&#xD;&#xA;$serviceContext = Get-SPServiceContext -Site $siteUrl&#xD;&#xA;$profileManager = New-Object Microsoft.Office.Server.UserProfiles.UserProfileManager($serviceContext);&#xD;&#xA;$profiles = $profileManager.GetEnumerator()&#xD;&#xA;&#xD;&#xA;$collection = @()&#xD;&#xA;foreach ($profile in $profiles) {&#xD;&#xA; &#xD;&#xA;   $profileData = &quot;&quot; | &#xD;&#xA;   select &quot;AccountName&quot;, &quot;PreferredName&quot; , &quot;Department&quot; , &quot;Manager&quot; , &quot;Office&quot; , &quot;Location&quot; , &quot;WorkEmail&quot; , &quot;Assistant&quot; , &quot;AboutMe&quot; , &quot;Language&quot; , &quot;PictureURL&quot; , &quot;Role&quot;&#xD;&#xA;   &#xD;&#xA;   $profileData.AccountName = $profile[&quot;AccountName&quot;]&#xD;&#xA;   $profileData.PreferredName = $profile[&quot;PreferredName&quot;]&#xD;&#xA;   $profileData.Manager = $profile[&quot;Manager&quot;]&#xD;&#xA;   $profileData.Department = $profile[&quot;Department&quot;]&#xD;&#xA;   $profileData.Office = $profile[&quot;Office&quot;]&#xD;&#xA;   $profileData.Location = $profile[&quot;Location&quot;]&#xD;&#xA;   $profileData.WorkEmail = $profile[&quot;WorkEmail&quot;]&#xD;&#xA;   $profileData.Assistant = $profile[&quot;Assistant&quot;]&#xD;&#xA;   $profileData.AboutMe = $profile[&quot;AboutMe&quot;].Value&#xD;&#xA;   $profileData.Language = $profile[&quot;Language&quot;]&#xD;&#xA;   $profileData.PictureURL = $profile[&quot;PictureURL&quot;]&#xD;&#xA;   $profileData.Role = $profile[&quot;Role&quot;]&#xD;&#xA;   &#xD;&#xA;   #$collection += $profileData | ConvertTo-Html -Fragment&#xD;&#xA;   $collection += $profileData&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;#ConvertTo-Html -Body &quot;$collection&quot; -CssUri C:\style.CSS | Out-File &quot;Location to save&quot;&#xD;&#xA;&#xD;&#xA;$collection | Export-Csv $outputFile -NoTypeInformation&#xD;&#xA;&#xD;&#xA;#Send Mail to Box for easy access&#xD;&#xA;$SMTP = &quot;Name of the SMTP Server&quot;&#xD;&#xA;$From = &quot;Email Address&quot;&#xD;&#xA;$To = &quot;Email Address&quot; , &quot;Email Address&quot;&#xD;&#xA;$Subject = &quot;User Profile Information Report&quot;&#xD;&#xA;Send-MailMessage -From $From -To $To -SmtpServer $SMTP -Subject $Subject -Attachments &quot;Same as Out-File Location&quot;" />
  <Code Content="# -----------------------------------------------------------------------------&#xD;&#xA;# Script&#x9;: To Export User Profile Information Value in Excel and HTML&#xD;&#xA;# Author&#x9;: Chendrayan Venkatesan&#xD;&#xA;# Date&#x9;&#x9;: October 1 2014&#xD;&#xA;# Version&#x9;: 1.1&#xD;&#xA;# -----------------------------------------------------------------------------&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;#. Use Internal name of the user profile property.&#xD;&#xA;#. Any custom user fields will have &quot;SPS-&quot;.&#xD;&#xA;#. Remove comment &quot;#&quot; in line 43 and do the same in line 48 if you need HTML output.&#xD;&#xA;#. Provide location after out-file to save the HTML file.&#xD;&#xA;#. In Line 59 use the same location as Out-File.&#xD;&#xA;#. Append if you have any custom fields in mysite user profile property&#xD;&#xA;#. For HTML look and feel please copy and paste the style.css in C:\.&#xD;&#xA;#. Use any style.css as per organization standard and policy.&#xD;&#xA;&#xD;&#xA;Add-PSSnapin Microsoft.SharePoint.PowerShell -ErrorAction SilentlyContinue&#xD;&#xA;&#xD;&#xA;$siteUrl = &quot;Your Mysite Host Name&quot;&#xD;&#xA;$outputFile = &quot;Save the Output File in your desired Location&quot;&#xD;&#xA;&#xD;&#xA;$serviceContext = Get-SPServiceContext -Site $siteUrl&#xD;&#xA;$profileManager = New-Object Microsoft.Office.Server.UserProfiles.UserProfileManager($serviceContext);&#xD;&#xA;$profiles = $profileManager.GetEnumerator()&#xD;&#xA;&#xD;&#xA;$collection = @()&#xD;&#xA;foreach ($profile in $profiles) {&#xD;&#xA; &#xD;&#xA;   $profileData = &quot;&quot; | &#xD;&#xA;   select &quot;AccountName&quot;, &quot;PreferredName&quot; , &quot;Department&quot; , &quot;Manager&quot; , &quot;Office&quot; , &quot;Location&quot; , &quot;WorkEmail&quot; , &quot;Assistant&quot; , &quot;AboutMe&quot; , &quot;Language&quot; , &quot;PictureURL&quot; , &quot;Role&quot;&#xD;&#xA;   &#xD;&#xA;   $profileData.AccountName = $profile[&quot;AccountName&quot;]&#xD;&#xA;   $profileData.PreferredName = $profile[&quot;PreferredName&quot;]&#xD;&#xA;   $profileData.Manager = $profile[&quot;Manager&quot;]&#xD;&#xA;   $profileData.Department = $profile[&quot;Department&quot;]&#xD;&#xA;   $profileData.Office = $profile[&quot;Office&quot;]&#xD;&#xA;   $profileData.Location = $profile[&quot;Location&quot;]&#xD;&#xA;   $profileData.WorkEmail = $profile[&quot;WorkEmail&quot;]&#xD;&#xA;   $profileData.Assistant = $profile[&quot;Assistant&quot;]&#xD;&#xA;   $profileData.AboutMe = $profile[&quot;AboutMe&quot;].Value&#xD;&#xA;   $profileData.Language = $profile[&quot;Language&quot;]&#xD;&#xA;   $profileData.PictureURL = $profile[&quot;PictureURL&quot;]&#xD;&#xA;   $profileData.Role = $profile[&quot;Role&quot;]&#xD;&#xA;   &#xD;&#xA;   #$collection += $profileData | ConvertTo-Html -Fragment&#xD;&#xA;   $collection += $profileData&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;#ConvertTo-Html -Body &quot;$collection&quot; -CssUri C:\style.CSS | Out-File &quot;Location to save&quot;&#xD;&#xA;&#xD;&#xA;$collection | Export-Csv $outputFile -NoTypeInformation&#xD;&#xA;&#xD;&#xA;#Send Mail to Box for easy access&#xD;&#xA;$SMTP = &quot;Name of the SMTP Server&quot;&#xD;&#xA;$From = &quot;Email Address&quot;&#xD;&#xA;$To = &quot;Email Address&quot; , &quot;Email Address&quot;&#xD;&#xA;$Subject = &quot;User Profile Information Report&quot;&#xD;&#xA;Send-MailMessage -From $From -To $To -SmtpServer $SMTP -Subject $Subject -Attachments &quot;Same as Out-File Location&quot;" />
</CodeSnippets>