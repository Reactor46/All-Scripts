<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="#-----------------------------------------------------------------------------  &#xD;&#xA;# Name:               Sync-SPUserInfoList.ps1   v2&#xD;&#xA;# Description:        This script will update all of the properties in the User&#xD;&#xA;#                     Information List with from the UPS&#xD;&#xA;# Usage:              Make sure the UPS is connected to the Central Admin WebApp  &#xD;&#xA;# By:                 Ivan Josipovic, Softlanding.ca   &#xD;&#xA;#-----------------------------------------------------------------------------  &#xD;&#xA;Add-PSSnapin Microsoft.SharePoint.PowerShell -ea 0; &#xD;&#xA;$ErrorActionPreference = &quot;SilentlyContinue&quot;; &#xD;&#xA;  &#xD;&#xA;$PropertyMap=@(&quot;Title,PreferredName,Display Name&quot;, &#xD;&#xA;&quot;EMail,WorkEmail,EMail&quot;, &#xD;&#xA;&quot;MobilePhone,CellPhone,Mobile Phone&quot;, &#xD;&#xA;&quot;Notes,AboutMe,About Me&quot;, &#xD;&#xA;&quot;SipAddress,WorkEmail,Sip Address&quot;, &#xD;&#xA;&quot;Picture,PictureURL,Picture URL&quot;, &#xD;&#xA;&quot;Department,Department,Department&quot;, &#xD;&#xA;&quot;JobTitle,SPS-JobTitle,Job Title&quot;, &#xD;&#xA;&quot;FirstName,FirstName,First Name&quot;, &#xD;&#xA;&quot;LastName,LastName,Last Name&quot;, &#xD;&#xA;&quot;WorkPhone,WorkPhone,Work Phone&quot;, &#xD;&#xA;&quot;UserName,UserName,UserName&quot;, &#xD;&#xA;&quot;WebSite,WebSite,WebSite&quot;, &#xD;&#xA;&quot;SPSResponsibility,SPS-Responsibility,Ask About Me&quot;, &#xD;&#xA;&quot;Office,Office,Office&quot;); &#xD;&#xA; &#xD;&#xA;$Context = Get-SPServiceContext $(Get-SPWebApplication -IncludeCentralAdministration | ? {$_.IsAdministrationWebApplication}).Url; &#xD;&#xA;$ProfileManager = New-Object Microsoft.Office.Server.UserProfiles.UserProfileManager($Context); &#xD;&#xA; &#xD;&#xA;if($ProfileManager){ &#xD;&#xA;    foreach ($Site in $(Get-SPSite -Limit All | ? {!$_.Url.Contains(&quot;Office_Viewing_Service_Cache&quot;)})){ &#xD;&#xA;        $RootWeb = $Site.RootWeb; &#xD;&#xA;        Write-Host $($Site.Url); &#xD;&#xA; &#xD;&#xA;        foreach ($User in $($RootWeb.SiteUsers)){ &#xD;&#xA;            if ($ProfileManager.UserExists($($User.UserLogin))){ &#xD;&#xA;                $UPUser = $ProfileManager.GetUserProfile($($User.UserLogin)); &#xD;&#xA;                $UserList = $RootWeb.SiteUserInfoList; &#xD;&#xA; &#xD;&#xA;                $Query = New-Object Microsoft.SharePoint.SPQuery; &#xD;&#xA;                $Query.Query = &quot;&lt;Where&gt;&lt;Eq&gt;&lt;FieldRef Name='Name' /&gt;&lt;Value Type='Text'&gt;$($User.UserLogin)&lt;/Value&gt;&lt;/Eq&gt;&lt;/Where&gt;&quot;; &#xD;&#xA;                $UserItem = $UserList.GetItems($Query)[0]; &#xD;&#xA; &#xD;&#xA;                ForEach ($Map in $PropertyMap){ &#xD;&#xA;                    $PropName = $Map.Split(',')[0]; &#xD;&#xA;                    $SiteProp = $UserItem[$PropName]; &#xD;&#xA;                    $UPSProp = $UPUser[$($Map.Split(',')[1])].Value; &#xD;&#xA;                    $DisplayName = $Map.Split(',')[2]; &#xD;&#xA;  &#xD;&#xA;                    if($PropName -eq &quot;Notes&quot;){ &#xD;&#xA;                        #Write-Host &quot;$DisplayName Updated: $SiteProp - $($UPSProp[0].Replace(&quot;&amp;nbsp;&quot;,&quot; &quot;))&quot;; &#xD;&#xA;                        $UserItem[$PropName] = $($UPSProp[0].Replace(&quot;&amp;nbsp;&quot;,&quot; &quot;)); &#xD;&#xA;                    }elseif($PropName -eq &quot;Picture&quot;){ &#xD;&#xA;                        #Write-Host &quot;$DisplayName Updated: $($SiteProp.Split(&quot;,&quot;)[0]) - $($UPSProp[0])&quot;; &#xD;&#xA;                        $UserItem[$PropName] = $UPSProp[0]; &#xD;&#xA;                    }elseif($PropName -eq &quot;SPSResponsibility&quot;){ &#xD;&#xA;                        #Write-Host &quot;$DisplayName Updated: $SiteProp - $($UPSProp -join ', ')&quot;; &#xD;&#xA;                        $UserItem[$PropName] = $($UPSProp -join ', '); &#xD;&#xA;                    }else{ &#xD;&#xA;                        #Write-Host &quot;$DisplayName Updated: $SiteProp - $UPSProp&quot;; &#xD;&#xA;                        $UserItem[$PropName] = $UPSProp; &#xD;&#xA;                    } &#xD;&#xA;                } &#xD;&#xA;                #Write-Host &quot;Saving: $($User.UserLogin)&quot;; &#xD;&#xA;                $UserItem.SystemUpdate(); &#xD;&#xA;                #Write-Host &quot;&quot;; &#xD;&#xA;            } &#xD;&#xA;        } &#xD;&#xA;        $RootWeb.Dispose(); &#xD;&#xA;        #Write-Host &quot;&quot;; &#xD;&#xA;    }  &#xD;&#xA;}else{ &#xD;&#xA;    Write-Host -foreground red &quot;Cant connect to the User Profile Service. Please make sure that the UPS is connected to the Central Administration Web Application. Also make sure that you have Administrator Rights to the User Profile Service&quot;; &#xD;&#xA;} " />
  <Code Content="#-----------------------------------------------------------------------------  &#xD;&#xA;# Name:               Sync-SPUserInfoList.ps1   v2&#xD;&#xA;# Description:        This script will update all of the properties in the User&#xD;&#xA;#                     Information List with from the UPS&#xD;&#xA;# Usage:              Make sure the UPS is connected to the Central Admin WebApp  &#xD;&#xA;# By:                 Ivan Josipovic, Softlanding.ca   &#xD;&#xA;#-----------------------------------------------------------------------------  &#xD;&#xA;Add-PSSnapin Microsoft.SharePoint.PowerShell -ea 0; &#xD;&#xA;$ErrorActionPreference = &quot;SilentlyContinue&quot;; &#xD;&#xA;  &#xD;&#xA;$PropertyMap=@(&quot;Title,PreferredName,Display Name&quot;, &#xD;&#xA;&quot;EMail,WorkEmail,EMail&quot;, &#xD;&#xA;&quot;MobilePhone,CellPhone,Mobile Phone&quot;, &#xD;&#xA;&quot;Notes,AboutMe,About Me&quot;, &#xD;&#xA;&quot;SipAddress,WorkEmail,Sip Address&quot;, &#xD;&#xA;&quot;Picture,PictureURL,Picture URL&quot;, &#xD;&#xA;&quot;Department,Department,Department&quot;, &#xD;&#xA;&quot;JobTitle,SPS-JobTitle,Job Title&quot;, &#xD;&#xA;&quot;FirstName,FirstName,First Name&quot;, &#xD;&#xA;&quot;LastName,LastName,Last Name&quot;, &#xD;&#xA;&quot;WorkPhone,WorkPhone,Work Phone&quot;, &#xD;&#xA;&quot;UserName,UserName,UserName&quot;, &#xD;&#xA;&quot;WebSite,WebSite,WebSite&quot;, &#xD;&#xA;&quot;SPSResponsibility,SPS-Responsibility,Ask About Me&quot;, &#xD;&#xA;&quot;Office,Office,Office&quot;); &#xD;&#xA; &#xD;&#xA;$Context = Get-SPServiceContext $(Get-SPWebApplication -IncludeCentralAdministration | ? {$_.IsAdministrationWebApplication}).Url; &#xD;&#xA;$ProfileManager = New-Object Microsoft.Office.Server.UserProfiles.UserProfileManager($Context); &#xD;&#xA; &#xD;&#xA;if($ProfileManager){ &#xD;&#xA;    foreach ($Site in $(Get-SPSite -Limit All | ? {!$_.Url.Contains(&quot;Office_Viewing_Service_Cache&quot;)})){ &#xD;&#xA;        $RootWeb = $Site.RootWeb; &#xD;&#xA;        Write-Host $($Site.Url); &#xD;&#xA; &#xD;&#xA;        foreach ($User in $($RootWeb.SiteUsers)){ &#xD;&#xA;            if ($ProfileManager.UserExists($($User.UserLogin))){ &#xD;&#xA;                $UPUser = $ProfileManager.GetUserProfile($($User.UserLogin)); &#xD;&#xA;                $UserList = $RootWeb.SiteUserInfoList; &#xD;&#xA; &#xD;&#xA;                $Query = New-Object Microsoft.SharePoint.SPQuery; &#xD;&#xA;                $Query.Query = &quot;&lt;Where&gt;&lt;Eq&gt;&lt;FieldRef Name='Name' /&gt;&lt;Value Type='Text'&gt;$($User.UserLogin)&lt;/Value&gt;&lt;/Eq&gt;&lt;/Where&gt;&quot;; &#xD;&#xA;                $UserItem = $UserList.GetItems($Query)[0]; &#xD;&#xA; &#xD;&#xA;                ForEach ($Map in $PropertyMap){ &#xD;&#xA;                    $PropName = $Map.Split(',')[0]; &#xD;&#xA;                    $SiteProp = $UserItem[$PropName]; &#xD;&#xA;                    $UPSProp = $UPUser[$($Map.Split(',')[1])].Value; &#xD;&#xA;                    $DisplayName = $Map.Split(',')[2]; &#xD;&#xA;  &#xD;&#xA;                    if($PropName -eq &quot;Notes&quot;){ &#xD;&#xA;                        #Write-Host &quot;$DisplayName Updated: $SiteProp - $($UPSProp[0].Replace(&quot;&amp;nbsp;&quot;,&quot; &quot;))&quot;; &#xD;&#xA;                        $UserItem[$PropName] = $($UPSProp[0].Replace(&quot;&amp;nbsp;&quot;,&quot; &quot;)); &#xD;&#xA;                    }elseif($PropName -eq &quot;Picture&quot;){ &#xD;&#xA;                        #Write-Host &quot;$DisplayName Updated: $($SiteProp.Split(&quot;,&quot;)[0]) - $($UPSProp[0])&quot;; &#xD;&#xA;                        $UserItem[$PropName] = $UPSProp[0]; &#xD;&#xA;                    }elseif($PropName -eq &quot;SPSResponsibility&quot;){ &#xD;&#xA;                        #Write-Host &quot;$DisplayName Updated: $SiteProp - $($UPSProp -join ', ')&quot;; &#xD;&#xA;                        $UserItem[$PropName] = $($UPSProp -join ', '); &#xD;&#xA;                    }else{ &#xD;&#xA;                        #Write-Host &quot;$DisplayName Updated: $SiteProp - $UPSProp&quot;; &#xD;&#xA;                        $UserItem[$PropName] = $UPSProp; &#xD;&#xA;                    } &#xD;&#xA;                } &#xD;&#xA;                #Write-Host &quot;Saving: $($User.UserLogin)&quot;; &#xD;&#xA;                $UserItem.SystemUpdate(); &#xD;&#xA;                #Write-Host &quot;&quot;; &#xD;&#xA;            } &#xD;&#xA;        } &#xD;&#xA;        $RootWeb.Dispose(); &#xD;&#xA;        #Write-Host &quot;&quot;; &#xD;&#xA;    }  &#xD;&#xA;}else{ &#xD;&#xA;    Write-Host -foreground red &quot;Cant connect to the User Profile Service. Please make sure that the UPS is connected to the Central Administration Web Application. Also make sure that you have Administrator Rights to the User Profile Service&quot;; &#xD;&#xA;} " />
</CodeSnippets>