<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="#Set Script Variables&#xD;&#xA;&#xD;&#xA;$SQLServer = &quot;SQLServerName&quot;&#xD;&#xA;$SQLAlias = &quot;AliasForSharePointSQL&quot;&#xD;&#xA;$FarmAccountUserName = &quot;Domain\User&quot;&#xD;&#xA;$FarmAccountPassword = &quot;AccountPassword&quot;&#xD;&#xA;$PassPhrase = &quot;FarmPassphrase&quot;&#xD;&#xA;$FarmConfigDatabase = &quot;SPFarm_ConfigDatabase&quot;&#xD;&#xA;$AdminContentDatabase = &quot;SPFarm_Admin_ContentDB&quot;&#xD;&#xA;$CentralAdminPort = 8080&#xD;&#xA;&#xD;&#xA;#Begin Farm Creation Script&#xD;&#xA;&#xD;&#xA;$x86 = &quot;HKLM:\Software\Microsoft\MSSQLServer\Client\ConnectTo&quot;&#xD;&#xA;$x64 = &quot;HKLM:\Software\Wow6432Node\Microsoft\MSSQLServer\Client\ConnectTo&quot;  &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if ((test-path -path $x86) -ne $True) &#xD;&#xA;{&#xD;&#xA;     write-host &quot;$x86 doesn't exist&quot;    &#xD;&#xA;&#x9;New-Item $x86 &#xD;&#xA;} &#xD;&#xA;&#xD;&#xA;if ((test-path -path $x64) -ne $True) &#xD;&#xA;{&#xD;&#xA;     write-host &quot;$x64 doesn't exist&quot;    &#xD;&#xA;&#x9;New-Item $x64 &#xD;&#xA;}   &#xD;&#xA;&#xD;&#xA;$TCPAlias = &quot;DBMSSOCN,&quot; + $SQLServer&#xD;&#xA;&#xD;&#xA;New-ItemProperty -Path $x86 -Name $SQLAlias -PropertyType String -Value $TCPAlias &#xD;&#xA;New-ItemProperty -Path $x64 -Name $SQLAlias -PropertyType String -Value $TCPAlias&#xD;&#xA;&#xD;&#xA;$FarmCredentials = New-Object System.Management.Automation.PSCredential $FarmAccountUserName, (ConvertTo-SecureString $FarmAccountPassword -AsPlainText -Force)&#xD;&#xA;$FarmPassphrase = (ConvertTo-SecureString $Passphrase -AsPlainText -force)&#xD;&#xA;New-SPConfigurationDatabase -DatabaseServer $SQLAlias -DatabaseName $FarmConfigDatabase -AdministrationContentDatabaseName $AdminContentDatabase -Passphrase $FarmPassphrase -FarmCredentials $FarmCredentials&#xD;&#xA;&#xD;&#xA;Initialize-SPResourceSecurity&#xD;&#xA;Install-SPService  &#xD;&#xA;Install-SPFeature -AllExistingFeatures &#xD;&#xA;&#xD;&#xA;New-SPCentralAdministration -Port $CentralAdminPort -WindowsAuthProvider NTLM &#xD;&#xA;Install-SPHelpCollection -All&#xD;&#xA;Install-SPApplicationContent&#xD;&#xA;&#xD;&#xA;$ServiceConnectionPoint = get-SPTopologyServiceApplication | select URI&#xD;&#xA;Set-SPFarmConfig -ServiceConnectionPointBindingInformation $ServiceConnectionPoint -Confirm:$False&#xD;&#xA;" />
  <Code Content="#Set Script Variables&#xD;&#xA;&#xD;&#xA;$SQLServer = &quot;SQLServerName&quot;&#xD;&#xA;$SQLAlias = &quot;AliasForSharePointSQL&quot;&#xD;&#xA;$FarmAccountUserName = &quot;Domain\User&quot;&#xD;&#xA;$FarmAccountPassword = &quot;AccountPassword&quot;&#xD;&#xA;$PassPhrase = &quot;FarmPassphrase&quot;&#xD;&#xA;$FarmConfigDatabase = &quot;SPFarm_ConfigDatabase&quot;&#xD;&#xA;$AdminContentDatabase = &quot;SPFarm_Admin_ContentDB&quot;&#xD;&#xA;$CentralAdminPort = 8080&#xD;&#xA;&#xD;&#xA;#Begin Farm Creation Script&#xD;&#xA;&#xD;&#xA;$x86 = &quot;HKLM:\Software\Microsoft\MSSQLServer\Client\ConnectTo&quot;&#xD;&#xA;$x64 = &quot;HKLM:\Software\Wow6432Node\Microsoft\MSSQLServer\Client\ConnectTo&quot;  &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if ((test-path -path $x86) -ne $True) &#xD;&#xA;{&#xD;&#xA;     write-host &quot;$x86 doesn't exist&quot;    &#xD;&#xA;&#x9;New-Item $x86 &#xD;&#xA;} &#xD;&#xA;&#xD;&#xA;if ((test-path -path $x64) -ne $True) &#xD;&#xA;{&#xD;&#xA;     write-host &quot;$x64 doesn't exist&quot;    &#xD;&#xA;&#x9;New-Item $x64 &#xD;&#xA;}   &#xD;&#xA;&#xD;&#xA;$TCPAlias = &quot;DBMSSOCN,&quot; + $SQLServer&#xD;&#xA;&#xD;&#xA;New-ItemProperty -Path $x86 -Name $SQLAlias -PropertyType String -Value $TCPAlias &#xD;&#xA;New-ItemProperty -Path $x64 -Name $SQLAlias -PropertyType String -Value $TCPAlias&#xD;&#xA;&#xD;&#xA;$FarmCredentials = New-Object System.Management.Automation.PSCredential $FarmAccountUserName, (ConvertTo-SecureString $FarmAccountPassword -AsPlainText -Force)&#xD;&#xA;$FarmPassphrase = (ConvertTo-SecureString $Passphrase -AsPlainText -force)&#xD;&#xA;New-SPConfigurationDatabase -DatabaseServer $SQLAlias -DatabaseName $FarmConfigDatabase -AdministrationContentDatabaseName $AdminContentDatabase -Passphrase $FarmPassphrase -FarmCredentials $FarmCredentials&#xD;&#xA;&#xD;&#xA;Initialize-SPResourceSecurity&#xD;&#xA;Install-SPService  &#xD;&#xA;Install-SPFeature -AllExistingFeatures &#xD;&#xA;&#xD;&#xA;New-SPCentralAdministration -Port $CentralAdminPort -WindowsAuthProvider NTLM &#xD;&#xA;Install-SPHelpCollection -All&#xD;&#xA;Install-SPApplicationContent&#xD;&#xA;&#xD;&#xA;$ServiceConnectionPoint = get-SPTopologyServiceApplication | select URI&#xD;&#xA;Set-SPFarmConfig -ServiceConnectionPointBindingInformation $ServiceConnectionPoint -Confirm:$False&#xD;&#xA;" />
</CodeSnippets>