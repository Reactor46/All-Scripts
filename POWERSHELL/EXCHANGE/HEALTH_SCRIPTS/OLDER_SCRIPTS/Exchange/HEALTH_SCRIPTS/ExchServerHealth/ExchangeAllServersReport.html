<html>
            <style>
            BODY{font-family: Arial; font-size: 8pt;}
            H1{font-size: 16px;}
            H2{font-size: 14px;}
            H3{font-size: 12px;}
            TABLE{border: 1px solid black; border-collapse: collapse; font-size: 8pt;}
            TH{border: 1px solid black; background: #dddddd; padding: 5px; color: #000000;}
            TD{border: 1px solid black; padding: 5px; }
            td.pass{background: #7FFF00;}
            td.warn{background: #FFE600;}
            td.fail{background: #FF0000; color: #ffffff;}
            td.info{background: #85D4FF;}
            </style>
            <body>
            <h1 align="center">Exchange Health Checker v2.22</h1>
            <p>This shows a breif overview of known areas of concern. Details about each server are below.</p>
            <p align='center'>Note: KBs that could be missing on the server are not included in this version of the script. Please check this in the .log file of the Health Checker script results</p><p>
                        <table>
                        <tr>
                        <th>Server Name</th>
                        <th>Virtual Server</th>
                        <th>Hardware Type</th>
                        <th>OS</th>
                        <th>Exchange Version</th>
                        <th>Build Number</th>
                        <th>Build Days Old</th>
                        <th>Server Role</th>
                        <th>Auto Page File</th>
						<th>System Memory</th>
                        <th>Multiple Page Files</th>
                        <th>Page File Size</th>
                        <th>.Net Version</th>
                        <th>Power Plan</th>
                        <th>Hyper-Threading</th>
                        <th>Processor Speed</th>
                        <th>Service Health</th>
                        <th>TCP Keep Alive</th>
                        <th>LmCompatibilityLevel</th>
                        </tr><H2>Servers Overview</H2><tr><td>LASEXCH01</td><td>Yes</td><td>VMWare</td><td>Microsoft Windows Server 2012 R2 Standard</td><td>Exchange 2016 CU8</td><td>15.1.1415.2</td><td class="fail">230</td><td>Mailbox</td><td>No</td><td>48 GB</td><td>No</td><td>32778</td><td>4.7.1</td><td>High performance</td><td>Disabled</td><td>2597</td><td>Healthy</td><td class="fail">Not Set</td><td>3</td></tr><tr><td>LASEXCH02</td><td>Yes</td><td>VMWare</td><td>Microsoft Windows Server 2012 R2 Standard</td><td>Exchange 2016 CU8</td><td>15.1.1415.2</td><td class="fail">230</td><td>Mailbox</td><td>No</td><td>48 GB</td><td>No</td><td>32778</td><td>4.7.1</td><td>High performance</td><td>Disabled</td><td>2597</td><td>Healthy</td><td class="fail">Not Set</td><td>3</td></tr><tr><td>LASEXCH03</td><td>Yes</td><td>VMWare</td><td>Microsoft Windows Server 2012 R2 Standard</td><td>Exchange 2016 CU8</td><td>15.1.1415.2</td><td class="fail">230</td><td>Mailbox</td><td>No</td><td>48 GB</td><td>No</td><td>32778</td><td>4.7.1</td><td>High performance</td><td>Disabled</td><td>2597</td><td>Healthy</td><td class="fail">Not Set</td><td>3</td></tr><tr><td>LASEXCH04</td><td>Yes</td><td>VMWare</td><td>Microsoft Windows Server 2012 R2 Standard</td><td>Exchange 2016 CU8</td><td>15.1.1415.2</td><td class="fail">230</td><td>Mailbox</td><td>No</td><td>48 GB</td><td>No</td><td>32778</td><td>4.7.1</td><td>High performance</td><td>Disabled</td><td>2597</td><td>Healthy</td><td class="fail">Not Set</td><td>3</td></tr></table></p><H2>Warnings/Errors in your environment.</H2><table><tr><td class="fail">Old Build</td><td>Error: Out of date Cumulative Update detected. Please upgrade to one of the two most recently released Cumulative Updates.</td></tr><tr><td class="fail">TCP Keep Alive</td><td>Error: The TCP KeepAliveTime value is not specified in the registry.  Without this value the KeepAliveTime defaults to two hours, which can cause connectivity and performance issues between network devices such as firewalls and load balancers depending on their configuration.  To avoid issues, add the KeepAliveTime REG_DWORD entry under HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Tcpip\Parameters and set it to a value between 900000 and 1800000 decimal.  You want to ensure that the TCP idle timeout value gets higher as you go out from Exchange, not lower.  For example if the Exchange server has a value of 30 minutes, the Load Balancer could have an idle timeout of 35 minutes, and the firewall could have an idle timeout of 40 minutes.  Please note that this change will require a restart of the system.  Refer to the sections "CAS Configuration" and "Load Balancer Configuration" in this blog post for more details:  https://blogs.technet.microsoft.com/exchange/2016/05/31/checklist-for-troubleshooting-outlook-connectivity-in-exchange-2013-and-2016-on-premises/</td></tr><tr><td class="warn">Virtual Servers</td><td>Virtual Machine detected.  Certain settings about the host hardware cannot be detected from the virtual machine.  Verify on the VM Host that: 

    - There is no more than a 1:1 Physical Core to Virtual CPU ratio (no oversubscribing)
    - If Hyper-Threading is enabled do NOT count Hyper-Threaded cores as physical cores
    - Do not oversubscribe memory or use dynamic memory allocation
    
Although Exchange technically supports up to a 2:1 physical core to vCPU ratio, a 1:1 ratio is strongly recommended for performance reasons.  Certain third party Hyper-Visors such as VMWare have their own guidance.  VMWare recommends a 1:1 ratio.  Their guidance can be found at https://www.vmware.com/files/pdf/Exchange_2013_on_VMware_Best_Practices_Guide.pdf.  For further details, please review the virtualization recommendations on TechNet at https://technet.microsoft.com/en-us/library/36184b2f-4cd9-48f8-b100-867fe4c6b579(v=exchg.150)#BKMK_Prereq.  Related specifically to VMWare, if you notice you are experiencing packet loss on your VMXNET3 adapter, you may want to review the following article from VMWare:  http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2039495. 
</td></tr><tr><td class="Warn">Multiple NICs</td><td>Multiple active network adapters detected. Exchange 2013 or greater may not need separate adapters for MAPI and replication traffic.  For details please refer to https://technet.microsoft.com/en-us/library/29bb0358-fc8e-4437-8feb-d2959ed0f102(v=exchg.150)#NR</td></tr><tr><td class="Warn">RSS</td><td>Enabling RSS is recommended.</td></tr></table><p><H2>Server Details</H2><table><tr><th>Server Name</th><th>LASEXCH01</th></tr><tr><td>Manufacturer</td><td></td></tr><tr><td>Model</td><td></td></tr><tr><td>Hardware Type</td><td>VMWare</td></tr><tr><td>Operating System</td><td>Microsoft Windows Server 2012 R2 Standard</td></tr><tr><td>Exchange</td><td>Exchange 2016 CU8</td></tr><tr><td>Build Number</td><td>15.1.1415.2</td></tr><tr><td>Server Role</td><td>Mailbox</td></tr><tr><td>System Memory</td><td>48 GB</td></tr><tr><td>Page File Size</td><td>32778</td></tr><tr><td>.Net Version Installed</td><td>4.7.1</td></tr><tr><td>HTTP Proxy</td><td><None></td></tr><tr><td>Processor</td><td>Intel(R) Xeon(R) CPU E5-2640 v3 @ 2.60GHz</td></tr><tr><td>Number of Processors</td><td>4</td></tr><tr><td>Logical/Physical Cores</td><td>8/8</td></tr><tr><td>Max Speed Per Core</td><td>2597</td></tr><tr><td>NUMA Group Size</td><td></td></tr><tr><td>All Procs Visible</td><td>Yes</td></tr><tr><td>System Memory</td><td>48 GB</td></tr><tr><td>Multiple NICs</td><td></td></tr><tr><td>Services Down</td><td></td></tr><tr><th>Server Name</th><th>LASEXCH02</th></tr><tr><td>Manufacturer</td><td></td></tr><tr><td>Model</td><td></td></tr><tr><td>Hardware Type</td><td>VMWare</td></tr><tr><td>Operating System</td><td>Microsoft Windows Server 2012 R2 Standard</td></tr><tr><td>Exchange</td><td>Exchange 2016 CU8</td></tr><tr><td>Build Number</td><td>15.1.1415.2</td></tr><tr><td>Server Role</td><td>Mailbox</td></tr><tr><td>System Memory</td><td>48 GB</td></tr><tr><td>Page File Size</td><td>32778</td></tr><tr><td>.Net Version Installed</td><td>4.7.1</td></tr><tr><td>HTTP Proxy</td><td><None></td></tr><tr><td>Processor</td><td>Intel(R) Xeon(R) CPU E5-2640 v3 @ 2.60GHz</td></tr><tr><td>Number of Processors</td><td>4</td></tr><tr><td>Logical/Physical Cores</td><td>8/8</td></tr><tr><td>Max Speed Per Core</td><td>2597</td></tr><tr><td>NUMA Group Size</td><td></td></tr><tr><td>All Procs Visible</td><td>Yes</td></tr><tr><td>System Memory</td><td>48 GB</td></tr><tr><td>Multiple NICs</td><td></td></tr><tr><td>Services Down</td><td></td></tr><tr><th>Server Name</th><th>LASEXCH03</th></tr><tr><td>Manufacturer</td><td></td></tr><tr><td>Model</td><td></td></tr><tr><td>Hardware Type</td><td>VMWare</td></tr><tr><td>Operating System</td><td>Microsoft Windows Server 2012 R2 Standard</td></tr><tr><td>Exchange</td><td>Exchange 2016 CU8</td></tr><tr><td>Build Number</td><td>15.1.1415.2</td></tr><tr><td>Server Role</td><td>Mailbox</td></tr><tr><td>System Memory</td><td>48 GB</td></tr><tr><td>Page File Size</td><td>32778</td></tr><tr><td>.Net Version Installed</td><td>4.7.1</td></tr><tr><td>HTTP Proxy</td><td><None></td></tr><tr><td>Processor</td><td>Intel(R) Xeon(R) CPU E5-2640 v3 @ 2.60GHz</td></tr><tr><td>Number of Processors</td><td>4</td></tr><tr><td>Logical/Physical Cores</td><td>8/8</td></tr><tr><td>Max Speed Per Core</td><td>2597</td></tr><tr><td>NUMA Group Size</td><td></td></tr><tr><td>All Procs Visible</td><td>Yes</td></tr><tr><td>System Memory</td><td>48 GB</td></tr><tr><td>Multiple NICs</td><td>Yes</td></tr><tr><td>Services Down</td><td></td></tr><tr><td>NIC Name</td><td>BackWater</td></tr><tr><td>NIC Description</td><td>vmxnet3 Ethernet Adapter #2</td></tr><tr><td>NIC Driver</td><td></td></tr><tr><td>NIC LinkSpeed</td><td>VM - Not Applicable</td></tr><tr><td>RSS</td><td>Disabled</td></tr><tr><td>NIC Name</td><td>Ethernet</td></tr><tr><td>NIC Description</td><td>vmxnet3 Ethernet Adapter</td></tr><tr><td>NIC Driver</td><td></td></tr><tr><td>NIC LinkSpeed</td><td>VM - Not Applicable</td></tr><tr><td>RSS</td><td>Disabled</td></tr><tr><th>Server Name</th><th>LASEXCH04</th></tr><tr><td>Manufacturer</td><td></td></tr><tr><td>Model</td><td></td></tr><tr><td>Hardware Type</td><td>VMWare</td></tr><tr><td>Operating System</td><td>Microsoft Windows Server 2012 R2 Standard</td></tr><tr><td>Exchange</td><td>Exchange 2016 CU8</td></tr><tr><td>Build Number</td><td>15.1.1415.2</td></tr><tr><td>Server Role</td><td>Mailbox</td></tr><tr><td>System Memory</td><td>48 GB</td></tr><tr><td>Page File Size</td><td>32778</td></tr><tr><td>.Net Version Installed</td><td>4.7.1</td></tr><tr><td>HTTP Proxy</td><td><None></td></tr><tr><td>Processor</td><td>Intel(R) Xeon(R) CPU E5-2640 v3 @ 2.60GHz</td></tr><tr><td>Number of Processors</td><td>4</td></tr><tr><td>Logical/Physical Cores</td><td>8/8</td></tr><tr><td>Max Speed Per Core</td><td>2597</td></tr><tr><td>NUMA Group Size</td><td></td></tr><tr><td>All Procs Visible</td><td>Yes</td></tr><tr><td>System Memory</td><td>48 GB</td></tr><tr><td>Multiple NICs</td><td>Yes</td></tr><tr><td>Services Down</td><td></td></tr><tr><td>NIC Name</td><td>PROD</td></tr><tr><td>NIC Description</td><td>vmxnet3 Ethernet Adapter</td></tr><tr><td>NIC Driver</td><td></td></tr><tr><td>NIC LinkSpeed</td><td>VM - Not Applicable</td></tr><tr><td>RSS</td><td>Disabled</td></tr><tr><td>NIC Name</td><td>BackWater</td></tr><tr><td>NIC Description</td><td>vmxnet3 Ethernet Adapter #2</td></tr><tr><td>NIC Driver</td><td></td></tr><tr><td>NIC LinkSpeed</td><td>VM - Not Applicable</td></tr><tr><td>RSS</td><td>Disabled</td></tr></table></p></body>
    </html>
